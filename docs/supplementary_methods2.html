<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Supplementary for the paper: Opportunities and Barriers for International Mangrove Conservation Leadership</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet" />
<script src="site_libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="site_libs/wordcloud2-0.0.1/hover.js"></script>
<script src="site_libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Cars</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="supplementary_methods2.html">Speed and Distance</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Supplementary for the paper: Opportunities and Barriers for International Mangrove Conservation Leadership</h1>

</div>


<div id="system-settings" class="section level1" number="1">
<h1><span class="header-section-number">1</span> System settings</h1>
<p>The analysis that follows was coded using the R programming language edited using the R-studio IDE. It is possible to reproduce the following analysis using a personal computer with a working internet connection. A <code>Rmd</code> version of this document can be downloaded by clicking the code tab in the upper right corner.</p>
<p>The analysis was made in the following R environment:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">platform_info</span>()</span></code></pre></div>
<pre><code>##  setting  value                       
##  version  R version 4.1.1 (2021-08-10)
##  os       Windows 10 x64              
##  system   x86_64, mingw32             
##  ui       RStudio                     
##  language (EN)                        
##  collate  English_United States.1252  
##  ctype    English_United States.1252  
##  tz       Europe/Berlin               
##  date     2021-10-25</code></pre>
<p>The packages needed to install are:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Publication trends section</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Google trends section</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtrendsR)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gratia)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud2)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="do">## load custom functions (by Dr. Gavin Simpson) to calculate GAM derivatives</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/CBMC-GCMP/custom_functions/main/derivFun.R&quot;</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/CBMC-GCMP/custom_functions/main/tsDiagGamm.R&quot;</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Custom function to obtain gtrends in loop </span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/CBMC-GCMP/custom_functions/main/search_gtrends&quot;</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Custom function to map gtrends results </span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/CBMC-GCMP/custom_functions/main/map_keyword_country.R&quot;</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Custom function to create wordclouds from related gtrend topics</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/CBMC-GCMP/custom_functions/main/wordcloud_topics.R&quot;</span>)</span></code></pre></div>
</div>
<div id="publication-trends" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Publication trends</h1>
<p>Scientific publications with the word “Mangrove” in their title were obtained using “Web of Science”. Results are by each country to which we then associate other data about mangrove cover and loss, as well as National Determinant Contribution index calculated in this manuscript.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading data ------------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Data on scientific publications</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>scientific_papers <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/CBMC-GCMP/open-data-CBMC/main/Mangrove-research/mangrove_publication_data_from_wos.csv&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Data on mangrove statistic by country</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>mangroves_stats <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/CBMC-GCMP/open-data-CBMC/main/Mangrove-research/mangrove_publication_data_country_stats.csv&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># National Determinant Contribution index calculated in this manuscript</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>NDCs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/CBMC-GCMP/open-data-CBMC/main/Mangrove-research/NDCPoints_1020212.csv&quot;</span>)</span></code></pre></div>
<p>As first step, we want to rearrange data to fit <code>tidy</code> standards.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data wrangling ----------------------------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>scientific_data <span class="ot">&lt;-</span> scientific_papers <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">% of All Papers</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">pivot_longer</span>(Worldwide<span class="sc">:</span>Rest) <span class="sc">%&gt;%</span>  <span class="co"># This pivot to longer dataset to be used in ggplot</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">replace_na</span>(value, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co"># replacing NAs </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">arrange</span>(name, Year) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cum_value =</span> <span class="fu">cumsum</span>(value))  <span class="co"># Calculating cumulative sums</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(scientific_data)</span></code></pre></div>
<pre><code>## Rows: 1,050
## Columns: 4
## Groups: name [15]
## $ Year      &lt;dbl&gt; 1903, 1917, 1919, 1933, 1940, 1941, 1949, 1950, 1955, 1956, 1959, 1962, 1963, 1964, 1965, 1~
## $ name      &lt;chr&gt; &quot;Australia&quot;, &quot;Australia&quot;, &quot;Australia&quot;, &quot;Australia&quot;, &quot;Australia&quot;, &quot;Australia&quot;, &quot;Australia&quot;, ~
## $ value     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 3, 3, 2, 8, 8~
## $ cum_value &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 5, 8, 10, 18,~</code></pre>
<p>Now, we can easily plot publications over time to see how each country performed in scientific production.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>for_barplot <span class="ot">&lt;-</span> scientific_data <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">==</span> <span class="st">&quot;Worldwide&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">fct_relevel</span>(name, <span class="st">&quot;Rest&quot;</span>, <span class="at">after =</span> <span class="dv">0</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>perc_rel <span class="ot">&lt;-</span> scientific_papers <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(Year, <span class="st">`</span><span class="at">% of All Papers</span><span class="st">`</span>) </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>for_barplot <span class="ot">&lt;-</span> <span class="fu">left_join</span>(for_barplot, perc_rel, <span class="at">by =</span> <span class="st">&quot;Year&quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>set3 <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">brewer.pal</span>(<span class="st">&#39;Set1&#39;</span>,<span class="at">n=</span><span class="dv">12</span>))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>pub_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> for_barplot, <span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y=</span>cum_value, <span class="at">fill=</span>name)) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(<span class="fu">set3</span>(<span class="dv">14</span>), <span class="fu">levels</span>(for_barplot<span class="sc">$</span>name))) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="dv">100</span><span class="sc">*</span><span class="st">`</span><span class="at">% of All Papers</span><span class="st">`</span>),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis=</span><span class="fu">sec_axis</span>(</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">~</span>.<span class="sc">*</span><span class="fl">0.0001</span>,<span class="at">name=</span><span class="st">&quot;% of papers published in the 13 mmrc&quot;</span>, <span class="at">labels=</span>scales<span class="sc">::</span>percent))<span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>, </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span><span class="st">&quot;# of publications&quot;</span>, </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">&quot;Country&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>pub_plot</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:Figure1"></span>
<img src="supplementary_methods2_files/figure-html/Figure1-1.png" alt="Publications over time" width="672" />
<p class="caption">
Figure 1: Publications over time
</p>
</div>
<p>To see differences in the # of publications within countries over time, we wanted to obtain a growth rate trend of the publications within each of the 13 countries with most mangrove areas, the rest of the world (i.e. all countries except the 13 selected), and worldwide. Due to the exponential nature of the growth we could should not use a linear model as it is shown in Figure <a href="#fig:Figure2">2</a>. Thus we used a Generalized Linear Model (GLM) with a Poisson log-link function to estimate the non-linear growth rate. This method has lot of flexibility to obtain the best fit for the growth rate. We explain the methodology in detail in Section <a href="#reasoning">2.1</a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A graph to see the difference betwen lm and glm with Poisson  -----------</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> scientific_data <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> cum_value, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> name)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">&quot;# of Publications&quot;</span>, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">&quot;LM (Gaussian distribution)&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.position =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span>  scientific_data <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> cum_value, </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> name)) <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">&quot;# of Publications&quot;</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">&quot;GLM (Poisson distribution)&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>),</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.position =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting both nicely</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;A&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:Figure2"></span>
<img src="supplementary_methods2_files/figure-html/Figure2-1.png" alt="Difference in calculating growth rate of publication by fitting a linear model (A) or a poisson log-link model (B)." width="672" />
<p class="caption">
Figure 2: Difference in calculating growth rate of publication by fitting a linear model (A) or a poisson log-link model (B).
</p>
</div>
<div id="reasoning" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Reasoning behind Poisson fitting for growth rate.</h2>
<p>The <code>glm</code> function allow to fit generalized linear models with log-links to fit curves with exponential shapes. An exponential growth describes the increase of a variable by the equation: <span class="math display">\[
N_{T} = \lambda^{T}N_{0}
\]</span></p>
<p>Where λ is the variable growth rate (in our case it would be publication increase rate), T is a number of time steps (in our case years) and N0 is the initial value of publications. We can take advantage of a log-link to linearize the equation as:</p>
<p><span class="math display">\[
log(N_T) = log(N_0) + log(\lambda^{T}) T
\]</span></p>
<p>Which compared to a generic Generalized Linear Model (GLM) equation with a log-link:</p>
<p><span class="math display">\[
log(y) = \beta_0 + \beta_1x_1
\]</span></p>
<p>Now a model estimates for the growth in publications number that depends on previous population size can be modeled as a rate:</p>
<p><span class="math display">\[
\frac{N_{T+1}}{N_T}
\]</span></p>
<p>We can use a log-link to linearize this rate term as:</p>
<p><span class="math display">\[
log(\frac{N_{T+1}}{N_T}) = \beta_0
\]</span></p>
<p><span class="math display">\[
log({N_{T+1}}) + log({N_T}) = \beta_0
\]</span></p>
<p><span class="math display">\[
log({N_{T+1}}) = \beta_0 + log({N_T})
\]</span></p>
<p>The <span class="math inline">\(log(N_T)\)</span> term, which has no coefficient associated to it, is an offset that can be modeled into the GLM in R code by:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(response <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">offset =</span> <span class="fu">log</span>(previous_number), </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data)</span></code></pre></div>
<p>The back-transformed intercept of the GLM model is the yearly rate of increase <span class="math inline">\(\frac{N_{T+1}}{N_T}\)</span>. In R we can obtain it as:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>growth_rate <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model))</span></code></pre></div>
<p>Where:</p>
<ul>
<li><p><code>exp()</code> transform back the exponential rate;</p></li>
<li><p><code>coef()</code> extract coefficient parameters from the <code>model</code> created using the <code>glm</code> function above.</p></li>
</ul>
<p>Thus, if there are <span class="math inline">\(N\)</span> publications for the year <span class="math inline">\(T\)</span>, if we want to know how many publications are in the following year <span class="math inline">\((T+1)\)</span> we just multiply the <code>growth_rate</code> obtained above by the number of the publications for the year <span class="math inline">\(T\)</span> or, <span class="math inline">\(N_T\)</span>:</p>
<p><span class="math display">\[
Growth rate * N_T = N_{T+1}
\]</span></p>
<div id="side-note" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Side note</h3>
<p>On a side note, this model could be improved further by introducing a Ricker model that approximate a logistic growth, by taking into account a carrying capacity within the model, thus allowing the growth rate to change as the number of publications increase. However, there is not really any evidence that this necessarily would occur and is out of the scope of this analysis.</p>
</div>
</div>
<div id="calculating-the-poisson-growth-rates" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Calculating the Poisson growth rates</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pois_rate <span class="ot">&lt;-</span> scientific_data <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(cum_value <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Year), </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cum_value_t =</span> <span class="fu">lag</span>(cum_value)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">split</span>(.<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">map</span>(<span class="sc">~</span><span class="fu">glm</span>(cum_value<span class="sc">~</span><span class="dv">1</span>, <span class="at">data =</span> .x, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">offset =</span> <span class="fu">log</span>(cum_value_t),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">map_df</span>(broom<span class="sc">::</span>tidy, <span class="at">.id =</span> <span class="st">&#39;name&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&#39;year&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Country =</span> name, <span class="at">Publications =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">pois_rate =</span> <span class="fu">round</span>(<span class="fu">exp</span>(Publications), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">arrange</span>(pois_rate) <span class="sc">%&gt;%</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Publications)</span></code></pre></div>
<p>Which gives:</p>
<pre><code>## # A tibble: 15 x 2
##    Country    pois_rate
##    &lt;chr&gt;          &lt;dbl&gt;
##  1 PNG             1.02
##  2 Venezuela       1.06
##  3 Australia       1.07
##  4 Nigeria         1.08
##  5 Mozambique      1.09
##  6 Rest            1.09
##  7 Cuba            1.1 
##  8 Worldwide       1.1 
##  9 India           1.11
## 10 Mexico          1.12
## 11 Brazil          1.13
## 12 Malaysia        1.13
## 13 Bangladesh      1.21
## 14 Indonesia       1.21
## 15 Myanmar         1.27</code></pre>
<p>The function calculated also Poisson rates for <code>Worldwide</code> and <code>Rest</code> category. The first represents all the publications around the world, whereas <code>Rest</code> represents all but the 13 countries publications.</p>
<p>Let’s now join the growth rates with mangrove stats by countries.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Joining the two model results by country name</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>m_dataset <span class="ot">&lt;-</span> <span class="fu">left_join</span>(pois_rate, mangroves_stats, <span class="at">by =</span> <span class="st">&quot;Country&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>          janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(<span class="sc">!</span>country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Rest&quot;</span>, <span class="st">&quot;Worldwide&quot;</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(m_dataset)</span></code></pre></div>
<pre><code>## Rows: 13
## Columns: 6
## $ country                               &lt;chr&gt; &quot;PNG&quot;, &quot;Venezuela&quot;, &quot;Australia&quot;, &quot;Nigeria&quot;, &quot;Mozambique&quot;, &quot;Cuba~
## $ pois_rate                             &lt;dbl&gt; 1.02, 1.06, 1.07, 1.08, 1.09, 1.10, 1.11, 1.12, 1.13, 1.13, 1.2~
## $ mangrove_coverage                     &lt;dbl&gt; 4762, 2796, 10060, 6958, 2986, 3343, 3521, 9537, 11072, 5201, 4~
## $ mitigation_potential_percent          &lt;dbl&gt; 34.9, 0.7, 0.5, 1.6, 8.2, 0.0, 0.0, 0.3, 0.7, -0.5, 1.5, 0.4, -~
## $ area_lost_per_year_km_2_yr            &lt;dbl&gt; 2.9355, 2.9315, 13.9025, 4.6940, 10.4215, 8.6950, 4.9815, 42.77~
## $ total_area_lost_between_1996_and_2016 &lt;dbl&gt; 58.71, 58.63, 278.05, 93.88, 208.43, 173.90, 99.63, 855.52, 352~</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m_dataset2 <span class="ot">&lt;-</span> m_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">pivot_longer</span>(mangrove_coverage<span class="sc">:</span>total_area_lost_between_1996_and_2016) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;area_lost_per_year_km_2_yr&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;mangrove_coverage&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;mitigation_potential_percent&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;area_lost_per_year_km_2_yr&quot;</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Mangrove coverage&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&quot;Mitigation potential (%)&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&quot;Area lost per year (km sq)&quot;</span>)))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>pois_plot <span class="ot">&lt;-</span> m_dataset2 <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pois_rate, <span class="at">x =</span> value, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">data =</span> m_dataset2[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">13</span>),], </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Area lost per year (log-scale)&quot;</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">&quot;Publication rate over time&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>tot_pub <span class="ot">&lt;-</span> scientific_data <span class="sc">%&gt;%</span> </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">tot_p =</span> <span class="fu">sum</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Rest&quot;</span>, <span class="st">&quot;Worldwide&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(<span class="at">Country =</span> name, tot_p)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>cov_mang_tot <span class="ot">&lt;-</span> <span class="fu">left_join</span>(mangroves_stats, tot_pub, <span class="at">by=</span><span class="st">&quot;Country&quot;</span>)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>mang_tot_plot <span class="ot">&lt;-</span> cov_mang_tot <span class="sc">%&gt;%</span> </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(Country, <span class="st">`</span><span class="at">Mangrove Coverage</span><span class="st">`</span>, tot_p) <span class="sc">%&gt;%</span> </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>(tot_p), <span class="at">x=</span>(<span class="st">`</span><span class="at">Mangrove Coverage</span><span class="st">`</span>), <span class="at">label =</span> Country)) <span class="sc">+</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">data =</span> cov_mang_tot[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),], </span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>                      <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mangrove Area (log-scale)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;# of publications (log-scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>() </span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>          )</span></code></pre></div>
<p>Now we can also reproduce the plot for Figure 1 in main text.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(pub_plot <span class="sc">|</span> (mang_tot_plot <span class="sc">/</span> pois_plot)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&#39;bold&#39;</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: ggrepel: 2 unlabeled data points (too many overlaps). Consider increasing max.overlaps</code></pre>
<div class="figure"><span style="display:block;" id="fig:mainfig"></span>
<img src="supplementary_methods2_files/figure-html/mainfig-1.png" alt="See captions in main text for Figure 1" width="960" />
<p class="caption">
Figure 3: See captions in main text for Figure 1
</p>
</div>
</div>
<div id="publication-rates-vs-mangrove-stats" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Publication rates <em>vs</em> mangrove stats</h2>
<p>Now that we calculated publication rates, we want to see within the 13 countries with most mangroves, if there is any relationship between:</p>
<ol style="list-style-type: decimal">
<li><p><strong>The number of publications within each country with the total mangrove area</strong>. As hypothesis, we wanted to test if a larger mangrove area extent was related to the number of publications in a country.</p></li>
<li><p><strong>The rate of publications over time within each country with the rate of mangrove area loss over time</strong>. As hypothesis, we wanted to test if a higher rate of mangrove loss was related to a higher rate of scientific publications.</p></li>
</ol>
<p>To test these two hypothesis we used Ordinary Least Square (OLS) models.</p>
<div id="number-of-publications-vs-total-mangrove-area" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Number of publications vs total mangrove area</h3>
<p>First, let’s see again how they look like.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing data to be modeled</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>tomodel <span class="ot">&lt;-</span> cov_mang_tot <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(<span class="at">country =</span> Country, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">mang_cover =</span> <span class="st">`</span><span class="at">Mangrove Coverage</span><span class="st">`</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                 tot_p)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tomodel, <span class="fu">aes</span>(<span class="at">x =</span> (mang_cover), </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> (tot_p), </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mangrove cover&quot;</span>, <span class="at">y=</span><span class="st">&quot;Total number of publications&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>() </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>          )</span></code></pre></div>
<p><img src="supplementary_methods2_files/figure-html/numPubArea-1.png" width="672" /></p>
<p>We can clearly see that there are some countries that do not conform to a linear relationship.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tot_p <span class="sc">~</span> mang_cover, <span class="at">data =</span> tomodel)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = tot_p ~ mang_cover, data = tomodel)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -319.24 -281.42 -215.09   71.49  902.85 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 2.749e+02  1.884e+02   1.459    0.173
## mang_cover  9.738e-03  1.946e-02   0.500    0.627
## 
## Residual standard error: 437.5 on 11 degrees of freedom
## Multiple R-squared:  0.02225,    Adjusted R-squared:  -0.06663 
## F-statistic: 0.2503 on 1 and 11 DF,  p-value: 0.6267</code></pre>
<p>The model <code>mod1</code> explains a statistically <strong>not</strong> significant and and weak proportion of variance (<span class="math inline">\(R^2\)</span> = 0.02, <span class="math inline">\(F\)</span>(1, 11) = 0.25, <span class="math inline">\(p\)</span> = 0.627, adj. <span class="math inline">\(R^2\)</span> = -0.07). The effect of the mangrove cover on the number of publications is statistically non-significant and positive (<span class="math inline">\(\beta\)</span> = <span class="math inline">\(9.74*10^{-3}\)</span>, 95% <span class="math inline">\(CI\)</span> [-0.03, 0.05], <span class="math inline">\(t\)</span>(11) = 0.50, <span class="math inline">\(p\)</span> = 0.627; Std. <span class="math inline">\(\beta\)</span> = 0.15, 95% <span class="math inline">\(CI\)</span> [-0.51, 0.81]).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:resMod1"></span>
<img src="supplementary_methods2_files/figure-html/resMod1-1.png" alt="Residuals of the full model" width="672" />
<p class="caption">
Figure 4: Residuals of the full model
</p>
</div>
<p>The reason for this poor fitting is caused by the influence of two countries: India and Indonesia. These two countries have much higher publications relative to mangrove areas compared to other countries, and Indonesia have much higher mangrove area relative to publication number. These two countries are special cases, that if removed from the model results in a significant relationship between the number of publications and total mangrove area as we see in the next graphs.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tot_p <span class="sc">~</span> mang_cover, <span class="at">data =</span> tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = tot_p ~ mang_cover, data = tomodel[-c(1, 10), ])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -310.20 -156.52   53.17  123.43  339.53 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) -333.19372  152.77798  -2.181  0.05709 . 
## mang_cover     0.10186    0.02305   4.419  0.00167 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 216.9 on 9 degrees of freedom
## Multiple R-squared:  0.6845, Adjusted R-squared:  0.6494 
## F-statistic: 19.53 on 1 and 9 DF,  p-value: 0.001674</code></pre>
<p>As we can see from the summary of the second model without India and Indonesia, <code>mod2</code>, the model explains a <strong>statistically significant</strong> and substantial proportion of variance (<span class="math inline">\(R^2\)</span> = 0.68, <span class="math inline">\(F\)</span>(1, 9) = 19.53, <span class="math inline">\(p\)</span> = 0.002, adj. <span class="math inline">\(R^2\)</span> = 0.65). The effect of mangrove cover over the number of publications is now significant and positive (<span class="math inline">\(\beta\)</span> = 0.10, 95% <span class="math inline">\(CI\)</span> [0.05, 0.15], <span class="math inline">\(t\)</span>(9) = 4.42, <span class="math inline">\(p\)</span> = 0.002; Std. <span class="math inline">\(\beta\)</span> = 0.83, 95% <span class="math inline">\(CI\)</span> [0.40, 1.25]).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),], <span class="fu">aes</span>(<span class="at">x =</span> mang_cover, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> tot_p, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mangrove cover&quot;</span>, <span class="at">y=</span> <span class="st">&quot;Total Number of Publications&quot;</span>, </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">title=</span><span class="st">&quot;Without India and Indonesia&quot;</span>) <span class="sc">+</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">data =</span> tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),], <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tomodel, <span class="fu">aes</span>(<span class="at">x =</span> mang_cover, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> tot_p, </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mangrove cover&quot;</span>, <span class="at">y=</span> <span class="st">&quot;Total Number of Publications&quot;</span>, </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">title=</span><span class="st">&quot;With India and Indonesia&quot;</span>) <span class="sc">+</span> </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">data =</span> tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),], <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;A&quot;</span>)</span></code></pre></div>
<p><img src="supplementary_methods2_files/figure-html/plotcountrytot-1.png" width="672" /></p>
</div>
<div id="rate-of-publications-vs-rate-of-mangrove-area-loss" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Rate of publications <em>vs</em> rate of mangrove area loss</h3>
<p>Similarly, we wanted to explore the relationships between the rate of publications and the rate of mangrove area loss over the years. We used a similar approach showed in Section <a href="#number-of-publications-vs-total-mangrove-area">2.3.1</a>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tomodel <span class="ot">&lt;-</span> m_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">pivot_longer</span>(mangrove_coverage<span class="sc">:</span>total_area_lost_between_1996_and_2016) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;mangrove_coverage&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(<span class="at">area_lost =</span> value, pois_rate, country)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tomodel, <span class="fu">aes</span>(<span class="at">x =</span> area_lost, <span class="at">y =</span> pois_rate, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mangrove loss per year (area)&quot;</span>, <span class="at">y=</span> <span class="st">&quot;Publications growth rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>          )</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ratepub"></span>
<img src="supplementary_methods2_files/figure-html/ratepub-1.png" alt="Growth rate of publications compared to the rate of mangrove area loss over the years" width="672" />
<p class="caption">
Figure 5: Growth rate of publications compared to the rate of mangrove area loss over the years
</p>
</div>
<p>From the plot in Figure <a href="#fig:ratepub">5</a>, we can see that a lot of the relationship is drawn by Indonesia. Myanmar and Bangladesh have a much higher rate of publications compared to other countries. Let’s fit the linear model to see the results.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pois_rate <span class="sc">~</span> area_lost, <span class="at">data =</span> tomodel)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pois_rate ~ area_lost, data = tomodel)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.093675 -0.041479 -0.008632  0.014765  0.155440 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.097e+00  2.947e-02  37.217 6.36e-13 ***
## area_lost   3.554e-06  3.044e-06   1.168    0.268    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06842 on 11 degrees of freedom
## Multiple R-squared:  0.1103, Adjusted R-squared:  0.02939 
## F-statistic: 1.363 on 1 and 11 DF,  p-value: 0.2676</code></pre>
<p>The relationship is not significant, and Bangladesh (11), Indonesia (12), and Myanmar (13), as expected show some issues in the model check plots in Figure <a href="#fig:residualsmod3">6</a>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod3)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:residualsmod3"></span>
<img src="supplementary_methods2_files/figure-html/residualsmod3-1.png" alt="Residuals of the full model" width="672" />
<p class="caption">
Figure 6: Residuals of the full model
</p>
</div>
<p>If we remove Myanmar and Bangladesh:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pois_rate <span class="sc">~</span> area_lost, <span class="at">data =</span> tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">13</span>),])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pois_rate ~ area_lost, data = tomodel[-c(11, 13), 
##     ])
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.065252 -0.015855  0.009704  0.018127  0.042446 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.060e+00  1.593e-02  66.542 1.97e-13 ***
## area_lost   5.245e-06  1.541e-06   3.404  0.00782 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03398 on 9 degrees of freedom
## Multiple R-squared:  0.5628, Adjusted R-squared:  0.5142 
## F-statistic: 11.59 on 1 and 9 DF,  p-value: 0.007825</code></pre>
<p>The model explains a <strong>statistically significant</strong> and substantial proportion of variance (<span class="math inline">\(R^2\)</span> = 0.56, <span class="math inline">\(F\)</span>(1, 9) = 11.59, <span class="math inline">\(p\)</span> = 0.008, adj. <span class="math inline">\(R^2\)</span> = 0.51). The effect of the rate of area lost for this set of countries in the rate of publications is statistically significant and positive (<span class="math inline">\(\beta\)</span> = 5.24e-06, 95% <span class="math inline">\(CI\)</span> [1.76e-06, 8.73e-06], <span class="math inline">\(t\)</span>(9) = 3.40, <span class="math inline">\(p\)</span> = 0.008; Std. <span class="math inline">\(\beta\)</span> = 0.75, 95% <span class="math inline">\(CI\)</span> [0.25, 1.25]).</p>
<p>Why Myanmar and Bangladesh are so different from the rest?</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># why should we remove Myanmar and Bangladesh?</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>scientific_data <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(cum_value <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">arrange</span>(<span class="sc">-</span>n)</span></code></pre></div>
<pre><code>## # A tibble: 15 x 2
## # Groups:   name [15]
##    name           n
##    &lt;chr&gt;      &lt;int&gt;
##  1 Rest          70
##  2 Worldwide     70
##  3 Australia     49
##  4 India         48
##  5 Malaysia      48
##  6 Venezuela     46
##  7 Cuba          45
##  8 Indonesia     44
##  9 Nigeria       42
## 10 Brazil        41
## 11 PNG           36
## 12 Mexico        34
## 13 Mozambique    29
## 14 Bangladesh    21
## 15 Myanmar       10</code></pre>
<p>They differ for having a very high rate of publications, where the number of publications increased rapidly in more recent years, and by having a smaller area lost per year rate than other countries with similar rates of publications.</p>
<p>However, if we see again Figure <a href="#fig:residualsmod3">6</a>, Indonesia, the Cook’s distance is large enough to consider it as an outlier. If we only remove Indonesia, the relationship is clearly much different and not significant (Figure <a href="#fig:finalfigpois">7</a></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">13</span>),], <span class="fu">aes</span>(<span class="at">x =</span> area_lost, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> pois_rate, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mangrove loss per year (area)&quot;</span>, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span> <span class="st">&quot;Publications growth rate&quot;</span>, </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">title=</span><span class="st">&quot;Without Myanmar and Bangladesh (significant)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">data =</span> tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">13</span>),], </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">12</span>),], <span class="fu">aes</span>(<span class="at">x =</span> area_lost, </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> pois_rate, </span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mangrove loss per year (area)&quot;</span>, </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span> <span class="st">&quot;Publications growth rate&quot;</span>, </span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">title=</span><span class="st">&quot;Without Indonesia&quot;</span>) <span class="sc">+</span> </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">data =</span> tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">12</span>),], </span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>),], <span class="fu">aes</span>(<span class="at">x =</span> area_lost, </span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> pois_rate, </span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mangrove loss per year (area)&quot;</span>, </span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span> <span class="st">&quot;Publications growth rate&quot;</span>, </span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>               <span class="at">title=</span><span class="st">&quot;Without Myanmar, Bangladesh, and Indonesia&quot;</span>) <span class="sc">+</span> </span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">data =</span> tomodel[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>),], </span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>                      <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tomodel, <span class="fu">aes</span>(<span class="at">x =</span> area_lost, </span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> pois_rate, </span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mangrove loss per year (area)&quot;</span>, </span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span> <span class="st">&quot;Publications growth rate&quot;</span>, </span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>               <span class="at">title=</span><span class="st">&quot;All countries&quot;</span>) <span class="sc">+</span> </span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">data =</span> tomodel, </span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>                      <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>(p1<span class="sc">+</span>p2)<span class="sc">/</span>(p3<span class="sc">+</span>p4) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;A&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider increasing max.overlaps</code></pre>
<pre><code>## Warning: ggrepel: 4 unlabeled data points (too many overlaps). Consider increasing max.overlaps</code></pre>
<div class="figure"><span style="display:block;" id="fig:finalfigpois"></span>
<img src="supplementary_methods2_files/figure-html/finalfigpois-1.png" alt="A) Relationship withouth Myanmar and Banglades is significant; B) Relationship without Indonesia is clearly much different and not significant; C) Relationship without the three countries is still not signficant; D) relationship with all countries." width="672" />
<p class="caption">
Figure 7: A) Relationship withouth Myanmar and Banglades is significant; B) Relationship without Indonesia is clearly much different and not significant; C) Relationship without the three countries is still not signficant; D) relationship with all countries.
</p>
</div>
</div>
</div>
</div>
<div id="national-determinant-contributions-relationship" class="section level1" number="3">
<h1><span class="header-section-number">3</span> National Determinant Contributions relationship</h1>
<p>We then tested to see if this knowledge and awareness translated into robust policy commitments by evaluating National Determinant Contributions (NDCs) under the Paris Agreement of the 13 most mangrove-rich countries.</p>
<p>We analyzed if NDCs addressed:</p>
<ol style="list-style-type: decimal">
<li><p>mangroves as mechanisms for climate adaptation or mitigation;</p></li>
<li><p>prioritization of mangrove conservation and restoration;</p></li>
<li><p>safeguarding against deforestation.</p></li>
</ol>
<p>We also noted if NDCs responded to calls for ecosystem monitoring. This evaluation was done by performing a text-based analysis of each country’s 2015 and 2020 submitted NDCs. The NDCs were scored based on if mangroves were included in their NDC and the level of commitment to mangrove conservation (Table 1 in main text). Countries could score a maximum of 15 points per NDC, for a total of 30 points if they submitted both a 2015 and 2020 NDC. If an NDC was not submitted, the score “0” was assigned.</p>
<p>Then, we compared the rates of publication against the difference in 2015 and 2020 NDC scores (2020 NDC score - 2015 NDC score). A positive difference in NDC scores reflects that 2020 NDCs have higher levels of commitment to mangrove conservation than in 2015, while a negative difference suggests that commitment levels to mangroves decreased from 2015 to 2020. We hypothesized that higher rates of publication would positively correlate with higher differences in NDC scores, indicating a relationship between growing scientific knowledge and greater level of policy commitments. Instead, we found a strong negative correlation between the two factors, in that higher publication rates correlated with lower differences in NDC scores. This result suggests that while scientific knowledge is being generated, this knowledge is not necessarily translating into policy action and improved commitments for mangrove conservation.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NDCs graph --------------------------------------------------------------</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>NDCs <span class="ot">&lt;-</span> <span class="fu">merge</span>(NDCs, pois_rate, <span class="at">by =</span> <span class="st">&quot;Country&quot;</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(NDCs, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pois_rate, </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Difference,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> Country)) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text_repel</span>() <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="supplementary_methods2_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>The model above is <strong>statistically significant</strong> and explains substantial proportion of variance (<span class="math inline">\(R^2\)</span> = 0.65, <span class="math inline">\(F\)</span>(1, 11) = 20.32, <span class="math inline">\(p\)</span> &lt; .001, adj. <span class="math inline">\(R^2\)</span> = 0.62). The effect of the rate of publications over the NDCs difference index is statistically significant and negative (<span class="math inline">\(\beta\)</span> = -60.23, 95% <span class="math inline">\(CI\)</span> [-89.63, -30.82], <span class="math inline">\(t\)</span>(11) = -4.51, <span class="math inline">\(p\)</span> &lt; .001; Std. <span class="math inline">\(\beta\)</span> = -0.81, 95% <span class="math inline">\(CI\)</span> [-1.20, -0.41]).</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ndcs_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Difference <span class="sc">~</span> pois_rate, <span class="at">data =</span> NDCs)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ndcs_mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Difference ~ pois_rate, data = NDCs)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6327 -1.1404  0.0146  1.5731  5.9483 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    66.48      15.03   4.423 0.001023 ** 
## pois_rate     -60.23      13.36  -4.508 0.000889 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.214 on 11 degrees of freedom
## Multiple R-squared:  0.6488, Adjusted R-squared:  0.6169 
## F-statistic: 20.32 on 1 and 11 DF,  p-value: 0.0008894</code></pre>
</div>
<div id="google-trends" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Google trends</h1>
<p>Google provides information on the interest over certain search terms through a “Interest over time” index. This index represent search interest relative to the highest point on the chart for a given region and time. A value of 100 is the peak popularity for the term. A value of 50 means that the term is half as popular. A score of 0 means there was not enough data for this term.</p>
<p>To download Google trends data we used the gtrendsR package which connects R to a gtrends API. Documentation on the package can be found <a href="https://gtrendr.readthedocs.io/en/latest/">here</a>. In this study we were interested in knowing whether the interest on mangroves changed significantly over time.</p>
<p>First we set keywords, we selected three different languages worldwide through a time span from 2004 to the present day<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>search_terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mangrove&quot;</span>, <span class="st">&quot;Manglar&quot;</span>, <span class="st">&quot;Bakau&quot;</span>)</span></code></pre></div>
<p>Then we ran the API request:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quering the API</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>output_results <span class="ot">&lt;-</span> <span class="fu">gtrends</span>(<span class="at">keyword =</span> search_terms,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">time =</span> <span class="st">&quot;all&quot;</span>) </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting interest over time results and converting them as numeric</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>output_results<span class="sc">$</span>interest_over_time<span class="sc">$</span>hits <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(output_results<span class="sc">$</span>interest_over_time<span class="sc">$</span>hits)</span></code></pre></div>
<p>Let’s plot the data by keywords:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>output_results <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>          .<span class="sc">$</span>interest_over_time <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(keyword <span class="sc">!=</span> <span class="st">&quot;Manglares&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> hits, <span class="at">col =</span> keyword)) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">&quot;Interest over time&quot;</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;Keyword&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="supplementary_methods2_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Clearly, the word most searched for is the English term, interestingly, the Spanish term had a very low popularity compared to the other languages.</p>
<div id="analysing-the-trend-an-example." class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Analysing the trend, an example.</h2>
<p>Trends are clearly non-linear so we opted to analyse these trends using Generalized Additive Models (GAMs). All trends show some degree of within-year seasonality which we decided to include into the models.</p>
<div id="english" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> English</h3>
<p>First we extract the English language from the Google data:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>engl_mod <span class="ot">&lt;-</span> output_results<span class="sc">$</span>interest_over_time <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(keyword <span class="sc">==</span> <span class="st">&quot;Mangrove&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date), <span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date))</span></code></pre></div>
<p>Then a GAM model is fitted using the <code>gamm</code> function from the <code>mgcv</code> package. In particular, we model Google trend data <code>hits</code> with two smooths, one for a month parameter using a cyclic spline (which forces starting point values to coincide with final ones), plus a year smooth which we leave undefined for now.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">gamm</span>(hits <span class="sc">~</span> <span class="fu">s</span>(month, <span class="at">bs =</span> <span class="st">&quot;cc&quot;</span>, <span class="at">k =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="fu">s</span>(year),</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> engl_mod)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>gratia<span class="sc">::</span><span class="fu">appraise</span>(m<span class="sc">$</span>gam)</span></code></pre></div>
<p><img src="supplementary_methods2_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>There is a bit of overdispertion, but first let’s address temporal autocorrelation.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">resid</span>(m<span class="sc">$</span>lme), <span class="at">lag.max =</span> <span class="dv">36</span>, <span class="at">main =</span> <span class="st">&quot;ACF&quot;</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">resid</span>(m<span class="sc">$</span>lme), <span class="at">lag.max =</span> <span class="dv">36</span>, <span class="at">main =</span> <span class="st">&quot;pACF&quot;</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<p><img src="supplementary_methods2_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>We can add ARMA correlation structure to reduce temporal autocorrelation.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m<span class="sc">$</span>lme, m1<span class="sc">$</span>lme, m2<span class="sc">$</span>lme, m3<span class="sc">$</span>lme)</span></code></pre></div>
<pre><code>##        Model df      AIC      BIC    logLik   Test  L.Ratio p-value
## m$lme      1  5 1513.741 1530.571 -751.8703                        
## m1$lme     2  6 1458.522 1478.718 -723.2609 1 vs 2 57.21878  &lt;.0001
## m2$lme     3  7 1460.050 1483.612 -723.0251 2 vs 3  0.47159  0.4923
## m3$lme     4  8 1462.013 1488.941 -723.0065 3 vs 4  0.03729  0.8469</code></pre>
<p>Model <code>m1</code> is the best.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1<span class="sc">$</span>lme, <span class="at">type =</span> <span class="st">&quot;normalized&quot;</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(res, <span class="at">main =</span> <span class="st">&quot;ACF - AR(2) errors&quot;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(res,  <span class="at">main =</span> <span class="st">&quot;pACF- AR(2) errors&quot;</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<p><img src="supplementary_methods2_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(m1<span class="sc">$</span>gam) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:gamplot"></span>
<img src="supplementary_methods2_files/figure-html/gamplot-1.png" alt="Model smooters" width="672" />
<p class="caption">
Figure 8: Model smooters
</p>
</div>
<p>From Figure <a href="#fig:gamplot">8</a> there is less interest over the late spring summer months, and after July interest seems to raise again. We can calculate derivatives (code below) to see significant increases over time:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>want <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(cet), <span class="at">length.out =</span> <span class="dv">214</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>pdat <span class="ot">&lt;-</span> <span class="fu">with</span>(cet,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">data.frame</span>(<span class="at">Time =</span> Time[want], <span class="at">date =</span> date[want],</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">month =</span> month[want]))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1<span class="sc">$</span>gam, <span class="at">newdata =</span> pdat, <span class="at">type =</span> <span class="st">&quot;terms&quot;</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>pdat <span class="ot">&lt;-</span> <span class="fu">transform</span>(pdat, <span class="at">p2 =</span> p2<span class="sc">$</span>fit[,<span class="dv">2</span>], <span class="at">se2 =</span> p2<span class="sc">$</span>se.fit[,<span class="dv">2</span>])</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>df.res <span class="ot">&lt;-</span> <span class="fu">df.residual</span>(m1<span class="sc">$</span>gam)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>crit.t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.025</span>, df.res, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>pdat <span class="ot">&lt;-</span> <span class="fu">transform</span>(pdat,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">upper =</span> p2 <span class="sc">+</span> (crit.t <span class="sc">*</span> se2),</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lower =</span> p2 <span class="sc">-</span> (crit.t <span class="sc">*</span> se2))</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>Term <span class="ot">&lt;-</span> <span class="st">&quot;Time&quot;</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>m1.d <span class="ot">&lt;-</span> <span class="fu">Deriv</span>(m1<span class="sc">$</span>gam)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>m1.dci <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1.d, <span class="at">term =</span> Term)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>m1.dsig <span class="ot">&lt;-</span> <span class="fu">signifD</span>(pdat<span class="sc">$</span>p2, <span class="at">d =</span> m1.d[[Term]]<span class="sc">$</span>deriv,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>                   m1.dci[[Term]]<span class="sc">$</span>upper, m1.dci[[Term]]<span class="sc">$</span>lower)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">with</span>(pdat, <span class="fu">range</span>(upper, lower, p2))</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>derivatives <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">date =</span> pdat<span class="sc">$</span>date,</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">increasing =</span> <span class="fu">unlist</span>(m1.dsig<span class="sc">$</span>incr), </span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">decreasing =</span> <span class="fu">unlist</span>(m1.dsig<span class="sc">$</span>decr), </span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">residuals =</span> <span class="fu">residuals</span>(m1<span class="sc">$</span>gam) <span class="sc">+</span> pdat<span class="sc">$</span>p2</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>(english_plot <span class="ot">&lt;-</span> pdat <span class="sc">%&gt;%</span> </span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> p2)) <span class="sc">+</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span> ) <span class="sc">+</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>          <span class="co">#geom_point(data = derivatives, aes(x=date, y=residuals), col = &quot;gray90&quot;) +</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>(<span class="at">data =</span> derivatives, <span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>residuals), <span class="at">col =</span> <span class="st">&quot;gray90&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">fill =</span> <span class="st">&quot;grey70&quot;</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>(<span class="at">data =</span> derivatives, </span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>increasing), </span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()))</span></code></pre></div>
<pre><code>## Warning: Removed 112 row(s) containing missing values (geom_path).</code></pre>
<p><img src="supplementary_methods2_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
</div>
<div id="the-13-countries-by-language" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> The 13 countries by language</h2>
<p>First, we create lists of countries by language. If we don’t separate countries by language, the gtrend tool will <em>compare</em> keywords within the country instead of giving overall results. Comparing term popularity in different languages within the same country does not really make sense. Thus, by creating a list by language we can then search the wanted keyword within that list.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only 13 countries by language, if wanted countries can be added by using iso2 code, e.g. for the USA would be US or United Kingom: UK. </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>eng_speaking <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AU&quot;</span>, <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;NG&quot;</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>portuguese_speaking <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;BR&quot;</span>, <span class="st">&quot;MZ&quot;</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>bakau_speaking <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;BD&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;MM&quot;</span>, <span class="st">&quot;MY&quot;</span>, <span class="st">&quot;PG&quot;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>spanish_speaking <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;CU&quot;</span>, <span class="st">&quot;MX&quot;</span>, <span class="st">&quot;VE&quot;</span>)</span></code></pre></div>
<p>Now, we use a custom function that searches for the keyword by looping over the country list.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>eng_data <span class="ot">&lt;-</span> <span class="fu">search_gtrends</span>(eng_speaking, <span class="at">keyword =</span> <span class="st">&quot;Mangrove&quot;</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>port_data <span class="ot">&lt;-</span> <span class="fu">search_gtrends</span>(portuguese_speaking, <span class="at">keyword =</span> <span class="st">&quot;Mangue&quot;</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>bak_data <span class="ot">&lt;-</span> <span class="fu">search_gtrends</span>(bakau_speaking, <span class="at">keyword =</span> <span class="st">&quot;Bakau&quot;</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>spa_data <span class="ot">&lt;-</span> <span class="fu">search_gtrends</span>(spanish_speaking, <span class="at">keyword =</span> <span class="st">&quot;Manglar&quot;</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># here we join all languages</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>google_trends_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(eng_data, port_data, bak_data, spa_data)</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>google_trends_data <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>hits)) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">facet_wrap</span>(<span class="sc">~</span>country) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Date&quot;</span>, <span class="at">y=</span><span class="st">&quot;Google trend index&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="supplementary_methods2_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="topics-wordcloud" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Topics wordcloud</h2>
<p>We can see wordclouds of related queries that were searched, and related topics to Mangroves in google trends.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud_topics</span>(<span class="st">&quot;Mangrove&quot;</span>,<span class="at">type =</span> <span class="st">&quot;Queries&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-4363a0e2cfd14ae87d95" style="width:672px;height:480px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-4363a0e2cfd14ae87d95">{"x":{"word":["fungsi hutan mangrove","fungsi mangrove","hutan mangrove","mangrove adalah","mangrove bay","mangrove beach","mangrove forest","mangrove forests","mangrove hotel","mangrove jack","mangrove jakarta","mangrove mountain","mangrove park","mangrove resort","mangrove snapper","mangrove tree","mangrove trees","mangroves","pantai mangrove","pik mangrove","red mangrove","taman mangrove","the mangrove","what is mangrove","wisata mangrove"],"freq":[22,24,100,25,19,18,60,14,22,21,14,13,13,21,21,25,23,25,18,17,16,15,68,21,25],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":1.8,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud_topics</span>(<span class="st">&quot;Mangrove&quot;</span>,<span class="at">type =</span> <span class="st">&quot;Topics&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-5063ff82e0ac8e51f956" style="width:672px;height:480px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-5063ff82e0ac8e51f956">{"x":{"word":["Beach","Coral reef","Ecosystem","Fish","Florida","Forest","Function","Gray snapper","Indonesia","Indonesian language","Island","Mangrove","Mangrove Ecotourism Centre PIK","Mangrove red snapper","Mangrove swamp","Plant","Reef","Region","Resort","Sea","Snappers","Swamp","Tourist attraction","Tree"],"freq":[5,5,5,4,5,26,5,4,6,7,4,116,4,5,4,6,4,4,4,4,5,4,6,8],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":4.6551724137931,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
</div>
<div id="lets-map-the-results-by-country" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Let’s map the results by country</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mangrove_map <span class="ot">&lt;-</span> <span class="fu">map_keyword_country</span>(<span class="at">keyword =</span> <span class="st">&quot;Mangrove&quot;</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>mangue_map <span class="ot">&lt;-</span> <span class="fu">map_keyword_country</span>(<span class="at">keyword =</span> <span class="st">&quot;Mangue&quot;</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>manglar_map <span class="ot">&lt;-</span> <span class="fu">map_keyword_country</span>(<span class="at">keyword =</span> <span class="st">&quot;Manglar&quot;</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>bakau_map <span class="ot">&lt;-</span> <span class="fu">map_keyword_country</span>(<span class="at">keyword =</span> <span class="st">&quot;Bakau&quot;</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>(mangrove_map <span class="sc">+</span> mangue_map) <span class="sc">/</span> (manglar_map <span class="sc">+</span> bakau_map)</span></code></pre></div>
<p><img src="supplementary_methods2_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div id="section" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> </h3>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Note that if you run this code after a while, it will automatically update to the latest result, thus it might differ from the paper.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIlN1cHBsZW1lbnRhcnkgZm9yIHRoZSBwYXBlcjogT3Bwb3J0dW5pdGllcyBhbmQgQmFycmllcnMgZm9yIEludGVybmF0aW9uYWwgTWFuZ3JvdmUgQ29uc2VydmF0aW9uIExlYWRlcnNoaXAiDQotLS0NCg0KYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0UsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQprbml0cjo6b3B0c19jaHVuayRzZXQoZWNobyA9IFRSVUUpDQpgYGANCg0KIyBTeXN0ZW0gc2V0dGluZ3MNCg0KVGhlIGFuYWx5c2lzIHRoYXQgZm9sbG93cyB3YXMgY29kZWQgdXNpbmcgdGhlIFIgcHJvZ3JhbW1pbmcgbGFuZ3VhZ2UgZWRpdGVkIHVzaW5nIHRoZSBSLXN0dWRpbyBJREUuIEl0IGlzIHBvc3NpYmxlIHRvIHJlcHJvZHVjZSB0aGUgZm9sbG93aW5nIGFuYWx5c2lzIHVzaW5nIGEgcGVyc29uYWwgY29tcHV0ZXIgd2l0aCBhIHdvcmtpbmcgaW50ZXJuZXQgY29ubmVjdGlvbi4gQSBgUm1kYCB2ZXJzaW9uIG9mIHRoaXMgZG9jdW1lbnQgY2FuIGJlIGRvd25sb2FkZWQgYnkgY2xpY2tpbmcgdGhlIGNvZGUgdGFiIGluIHRoZSB1cHBlciByaWdodCBjb3JuZXIuDQoNClRoZSBhbmFseXNpcyB3YXMgbWFkZSBpbiB0aGUgZm9sbG93aW5nIFIgZW52aXJvbm1lbnQ6DQoNCmBgYHtyfQ0Kc2Vzc2lvbmluZm86OnBsYXRmb3JtX2luZm8oKQ0KYGBgDQoNClRoZSBwYWNrYWdlcyBuZWVkZWQgdG8gaW5zdGFsbCBhcmU6DQoNCmBgYHtyIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQoNCiMjIFB1YmxpY2F0aW9uIHRyZW5kcyBzZWN0aW9uDQpsaWJyYXJ5KHRpZHl2ZXJzZSkNCmxpYnJhcnkoZ2dyZXBlbCkNCmxpYnJhcnkoUkNvbG9yQnJld2VyKQ0KbGlicmFyeShwYXRjaHdvcmspDQoNCiMjIEdvb2dsZSB0cmVuZHMgc2VjdGlvbg0KbGlicmFyeShndHJlbmRzUikNCmxpYnJhcnkodGlkeXZlcnNlKQ0KbGlicmFyeShyZWFkeGwpDQpsaWJyYXJ5KG1nY3YpDQpsaWJyYXJ5KG5sbWUpDQpsaWJyYXJ5KGdyYXRpYSkNCmxpYnJhcnkoc2YpDQpsaWJyYXJ5KHJuYXR1cmFsZWFydGgpDQpsaWJyYXJ5KHdvcmRjbG91ZDIpDQoNCiMjIGxvYWQgY3VzdG9tIGZ1bmN0aW9ucyAoYnkgRHIuIEdhdmluIFNpbXBzb24pIHRvIGNhbGN1bGF0ZSBHQU0gZGVyaXZhdGl2ZXMNCnNvdXJjZSgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0NCTUMtR0NNUC9jdXN0b21fZnVuY3Rpb25zL21haW4vZGVyaXZGdW4uUiIpDQpzb3VyY2UoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9DQk1DLUdDTVAvY3VzdG9tX2Z1bmN0aW9ucy9tYWluL3RzRGlhZ0dhbW0uUiIpDQoNCiMjIEN1c3RvbSBmdW5jdGlvbiB0byBvYnRhaW4gZ3RyZW5kcyBpbiBsb29wIA0KDQpzb3VyY2UoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9DQk1DLUdDTVAvY3VzdG9tX2Z1bmN0aW9ucy9tYWluL3NlYXJjaF9ndHJlbmRzIikNCg0KIyMgQ3VzdG9tIGZ1bmN0aW9uIHRvIG1hcCBndHJlbmRzIHJlc3VsdHMgDQoNCnNvdXJjZSgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0NCTUMtR0NNUC9jdXN0b21fZnVuY3Rpb25zL21haW4vbWFwX2tleXdvcmRfY291bnRyeS5SIikNCg0KIyMgQ3VzdG9tIGZ1bmN0aW9uIHRvIGNyZWF0ZSB3b3JkY2xvdWRzIGZyb20gcmVsYXRlZCBndHJlbmQgdG9waWNzDQpzb3VyY2UoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9DQk1DLUdDTVAvY3VzdG9tX2Z1bmN0aW9ucy9tYWluL3dvcmRjbG91ZF90b3BpY3MuUiIpDQoNCmBgYA0KDQojIFB1YmxpY2F0aW9uIHRyZW5kcw0KDQpTY2llbnRpZmljIHB1YmxpY2F0aW9ucyB3aXRoIHRoZSB3b3JkICJNYW5ncm92ZSIgaW4gdGhlaXIgdGl0bGUgd2VyZSBvYnRhaW5lZCB1c2luZyAiV2ViIG9mIFNjaWVuY2UiLiBSZXN1bHRzIGFyZSBieSBlYWNoIGNvdW50cnkgdG8gd2hpY2ggd2UgdGhlbiBhc3NvY2lhdGUgb3RoZXIgZGF0YSBhYm91dCBtYW5ncm92ZSBjb3ZlciBhbmQgbG9zcywgYXMgd2VsbCBhcyBOYXRpb25hbCBEZXRlcm1pbmFudCBDb250cmlidXRpb24gaW5kZXggY2FsY3VsYXRlZCBpbiB0aGlzIG1hbnVzY3JpcHQuDQoNCmBgYHtyIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQoNCiMgTG9hZGluZyBkYXRhIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQojIERhdGEgb24gc2NpZW50aWZpYyBwdWJsaWNhdGlvbnMNCnNjaWVudGlmaWNfcGFwZXJzIDwtIHJlYWRfY3N2KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ0JNQy1HQ01QL29wZW4tZGF0YS1DQk1DL21haW4vTWFuZ3JvdmUtcmVzZWFyY2gvbWFuZ3JvdmVfcHVibGljYXRpb25fZGF0YV9mcm9tX3dvcy5jc3YiKQ0KDQojIERhdGEgb24gbWFuZ3JvdmUgc3RhdGlzdGljIGJ5IGNvdW50cnkNCm1hbmdyb3Zlc19zdGF0cyA8LSByZWFkX2NzdigiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0NCTUMtR0NNUC9vcGVuLWRhdGEtQ0JNQy9tYWluL01hbmdyb3ZlLXJlc2VhcmNoL21hbmdyb3ZlX3B1YmxpY2F0aW9uX2RhdGFfY291bnRyeV9zdGF0cy5jc3YiKQ0KDQojIE5hdGlvbmFsIERldGVybWluYW50IENvbnRyaWJ1dGlvbiBpbmRleCBjYWxjdWxhdGVkIGluIHRoaXMgbWFudXNjcmlwdA0KTkRDcyA8LSByZWFkX2NzdigiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0NCTUMtR0NNUC9vcGVuLWRhdGEtQ0JNQy9tYWluL01hbmdyb3ZlLXJlc2VhcmNoL05EQ1BvaW50c18xMDIwMjEyLmNzdiIpDQoNCg0KDQpgYGANCg0KQXMgZmlyc3Qgc3RlcCwgd2Ugd2FudCB0byByZWFycmFuZ2UgZGF0YSB0byBmaXQgYHRpZHlgIHN0YW5kYXJkcy4NCg0KYGBge3J9DQojIERhdGEgd3JhbmdsaW5nIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0Kc2NpZW50aWZpY19kYXRhIDwtIHNjaWVudGlmaWNfcGFwZXJzICU+JQ0KICAgICAgICAgIGRwbHlyOjpzZWxlY3QoLWAlIG9mIEFsbCBQYXBlcnNgKSAlPiUNCiAgICAgICAgICBwaXZvdF9sb25nZXIoV29ybGR3aWRlOlJlc3QpICU+JSAgIyBUaGlzIHBpdm90IHRvIGxvbmdlciBkYXRhc2V0IHRvIGJlIHVzZWQgaW4gZ2dwbG90DQogICAgICAgICAgbXV0YXRlKHZhbHVlID0gcmVwbGFjZV9uYSh2YWx1ZSwgMCkpICU+JSAjIHJlcGxhY2luZyBOQXMgDQogICAgICAgICAgYXJyYW5nZShuYW1lLCBZZWFyKSAlPiUNCiAgICAgICAgICBncm91cF9ieShuYW1lKSAlPiUNCiAgICAgICAgICBkcGx5cjo6bXV0YXRlKGN1bV92YWx1ZSA9IGN1bXN1bSh2YWx1ZSkpICAjIENhbGN1bGF0aW5nIGN1bXVsYXRpdmUgc3Vtcw0KDQpnbGltcHNlKHNjaWVudGlmaWNfZGF0YSkNCmBgYA0KDQpOb3csIHdlIGNhbiBlYXNpbHkgcGxvdCBwdWJsaWNhdGlvbnMgb3ZlciB0aW1lIHRvIHNlZSBob3cgZWFjaCBjb3VudHJ5IHBlcmZvcm1lZCBpbiBzY2llbnRpZmljIHByb2R1Y3Rpb24uDQoNCmBgYHtyIEZpZ3VyZTEsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0UsIGZpZy5jYXA9IlB1YmxpY2F0aW9ucyBvdmVyIHRpbWUifQ0KDQoNCmZvcl9iYXJwbG90IDwtIHNjaWVudGlmaWNfZGF0YSAlPiUgDQogICAgICAgICAgZmlsdGVyKCFuYW1lID09ICJXb3JsZHdpZGUiKSAlPiUgDQogICAgICAgICAgbXV0YXRlKG5hbWUgPSBmYWN0b3IobmFtZSkpICU+JSANCiAgICAgICAgICBtdXRhdGUobmFtZSA9IGZjdF9yZWxldmVsKG5hbWUsICJSZXN0IiwgYWZ0ZXIgPSAwKSkNCg0KcGVyY19yZWwgPC0gc2NpZW50aWZpY19wYXBlcnMgJT4lIA0KICAgICAgICAgIHNlbGVjdChZZWFyLCBgJSBvZiBBbGwgUGFwZXJzYCkgDQoNCmZvcl9iYXJwbG90IDwtIGxlZnRfam9pbihmb3JfYmFycGxvdCwgcGVyY19yZWwsIGJ5ID0gIlllYXIiKQ0KDQpzZXQzIDwtIGNvbG9yUmFtcFBhbGV0dGUoYnJld2VyLnBhbCgnU2V0MScsbj0xMikpDQoNCnB1Yl9wbG90IDwtIGdncGxvdChkYXRhID0gZm9yX2JhcnBsb3QsIGFlcyh4PVllYXIsIHk9Y3VtX3ZhbHVlLCBmaWxsPW5hbWUpKSArDQogICAgICAgICAgZ2VvbV9jb2woKSsNCiAgICAgICAgICBzY2FsZV9maWxsX21hbnVhbCh2YWx1ZXMgPSBzZXROYW1lcyhzZXQzKDE0KSwgbGV2ZWxzKGZvcl9iYXJwbG90JG5hbWUpKSkgKw0KICAgICAgICAgIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDApICsNCiAgICAgICAgICBnZW9tX2xpbmUoYWVzKHggPSBZZWFyLCANCiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAxMDAqYCUgb2YgQWxsIFBhcGVyc2ApLA0KICAgICAgICAgICAgICAgICAgICBzdGF0ID0gImlkZW50aXR5IikgKw0KICAgICAgICAgIHNjYWxlX3lfY29udGludW91cyhzZWMuYXhpcz1zZWNfYXhpcygNCiAgICAgICAgICAgICAgICAgICAgfi4qMC4wMDAxLG5hbWU9IiUgb2YgcGFwZXJzIHB1Ymxpc2hlZCBpbiB0aGUgMTMgbW1yYyIsIGxhYmVscz1zY2FsZXM6OnBlcmNlbnQpKSsNCiAgICAgICAgICBsYWJzKHg9IlllYXIiLCANCiAgICAgICAgICAgICAgIHk9IiMgb2YgcHVibGljYXRpb25zIiwgDQogICAgICAgICAgICAgICBmaWxsPSJDb3VudHJ5IikgKw0KICAgICAgICAgIHRoZW1lX2J3KCkgKw0KICAgICAgICAgIHRoZW1lKHBhbmVsLmdyaWQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgICAgICAgICAgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpDQoNCnB1Yl9wbG90DQoNCmBgYA0KDQpUbyBzZWUgZGlmZmVyZW5jZXMgaW4gdGhlIFwjIG9mIHB1YmxpY2F0aW9ucyB3aXRoaW4gY291bnRyaWVzIG92ZXIgdGltZSwgd2Ugd2FudGVkIHRvIG9idGFpbiBhIGdyb3d0aCByYXRlIHRyZW5kIG9mIHRoZSBwdWJsaWNhdGlvbnMgd2l0aGluIGVhY2ggb2YgdGhlIDEzIGNvdW50cmllcyB3aXRoIG1vc3QgbWFuZ3JvdmUgYXJlYXMsIHRoZSByZXN0IG9mIHRoZSB3b3JsZCAoaS5lLiBhbGwgY291bnRyaWVzIGV4Y2VwdCB0aGUgMTMgc2VsZWN0ZWQpLCBhbmQgd29ybGR3aWRlLiBEdWUgdG8gdGhlIGV4cG9uZW50aWFsIG5hdHVyZSBvZiB0aGUgZ3Jvd3RoIHdlIGNvdWxkIHNob3VsZCBub3QgdXNlIGEgbGluZWFyIG1vZGVsIGFzIGl0IGlzIHNob3duIGluIEZpZ3VyZSBcQHJlZihmaWc6RmlndXJlMikuIFRodXMgd2UgdXNlZCBhIEdlbmVyYWxpemVkIExpbmVhciBNb2RlbCAoR0xNKSB3aXRoIGEgUG9pc3NvbiBsb2ctbGluayBmdW5jdGlvbiB0byBlc3RpbWF0ZSB0aGUgbm9uLWxpbmVhciBncm93dGggcmF0ZS4gVGhpcyBtZXRob2QgaGFzIGxvdCBvZiBmbGV4aWJpbGl0eSB0byBvYnRhaW4gdGhlIGJlc3QgZml0IGZvciB0aGUgZ3Jvd3RoIHJhdGUuIFdlIGV4cGxhaW4gdGhlIG1ldGhvZG9sb2d5IGluIGRldGFpbCBpbiBTZWN0aW9uIFxAcmVmKHJlYXNvbmluZykuDQoNCmBgYHtyIEZpZ3VyZTIsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0UsIGZpZy5jYXA9IkRpZmZlcmVuY2UgaW4gY2FsY3VsYXRpbmcgZ3Jvd3RoIHJhdGUgb2YgcHVibGljYXRpb24gYnkgZml0dGluZyBhIGxpbmVhciBtb2RlbCAoQSkgb3IgYSBwb2lzc29uIGxvZy1saW5rIG1vZGVsIChCKS4ifQ0KDQojIEEgZ3JhcGggdG8gc2VlIHRoZSBkaWZmZXJlbmNlIGJldHdlbiBsbSBhbmQgZ2xtIHdpdGggUG9pc3NvbiAgLS0tLS0tLS0tLS0NCg0KcDEgPC0gc2NpZW50aWZpY19kYXRhICU+JQ0KICAgICAgICAgIGdncGxvdChhZXMoeCA9IFllYXIsIA0KICAgICAgICAgICAgICAgICAgICAgeSA9IGN1bV92YWx1ZSwgDQogICAgICAgICAgICAgICAgICAgICBjb2wgPSBuYW1lKSkgKw0KICAgICAgICAgIGxhYnMoeCA9ICJUaW1lIiwgDQogICAgICAgICAgICAgICB5ID0gIiMgb2YgUHVibGljYXRpb25zIiwgDQogICAgICAgICAgICAgICB0aXRsZSA9ICJMTSAoR2F1c3NpYW4gZGlzdHJpYnV0aW9uKSIpICsNCiAgICAgICAgICBnZW9tX3Ntb290aChtZXRob2QgPSAibG0iKSArDQogICAgICAgICAgdGhlbWVfYncoKSArDQogICAgICAgICAgdGhlbWUocGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgICAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgICAgICAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICIiDQogICAgICAgICAgKQ0KDQpwMiA8LSAgc2NpZW50aWZpY19kYXRhICU+JQ0KICAgICAgICAgIGdncGxvdChhZXMoeCA9IFllYXIsDQogICAgICAgICAgICAgICAgICAgICB5ID0gY3VtX3ZhbHVlLCANCiAgICAgICAgICAgICAgICAgICAgIGNvbCA9IG5hbWUpKSArDQogICAgICAgICAgbGFicyh4ID0gIlRpbWUiLCANCiAgICAgICAgICAgICAgIHkgPSAiIyBvZiBQdWJsaWNhdGlvbnMiLA0KICAgICAgICAgICAgICAgdGl0bGUgPSAiR0xNIChQb2lzc29uIGRpc3RyaWJ1dGlvbikiKSArDQogICAgICAgICAgZ2VvbV9zbW9vdGgoDQogICAgICAgICAgICAgICAgICAgIG1ldGhvZCA9ICJnbG0iLA0KICAgICAgICAgICAgICAgICAgICBzZSA9IEZBTFNFLA0KICAgICAgICAgICAgICAgICAgICBtZXRob2QuYXJncyA9IGxpc3QoZmFtaWx5ID0gInBvaXNzb24iKSwNCiAgICAgICAgICAgICAgICAgICAgbGluZXR5cGUgPSAiZGFzaGVkIg0KICAgICAgICAgICkgKw0KICAgICAgICAgIHRoZW1lX2J3KCkgKw0KICAgICAgICAgIHRoZW1lKHBhbmVsLmdyaWQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgICAgICAgICAgc3RyaXAuYmFja2dyb3VuZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgICAgICAgICBsZWdlbmQucG9zaXRpb24gPSAiIg0KICAgICAgICAgICkNCg0KIyBQbG90dGluZyBib3RoIG5pY2VseQ0KcDEgKyBwMiArDQogICAgICAgICAgcGxvdF9hbm5vdGF0aW9uKHRhZ19sZXZlbHMgPSAiQSIpDQoNCmBgYA0KDQojIyBSZWFzb25pbmcgYmVoaW5kIFBvaXNzb24gZml0dGluZyBmb3IgZ3Jvd3RoIHJhdGUuIHsjcmVhc29uaW5nfQ0KDQpUaGUgYGdsbWAgZnVuY3Rpb24gYWxsb3cgdG8gZml0IGdlbmVyYWxpemVkIGxpbmVhciBtb2RlbHMgd2l0aCBsb2ctbGlua3MgdG8gZml0IGN1cnZlcyB3aXRoIGV4cG9uZW50aWFsIHNoYXBlcy4gQW4gZXhwb25lbnRpYWwgZ3Jvd3RoIGRlc2NyaWJlcyB0aGUgaW5jcmVhc2Ugb2YgYSB2YXJpYWJsZSBieSB0aGUgZXF1YXRpb246ICQkDQpOX3tUfSA9IFxsYW1iZGFee1R9Tl97MH0NCiQkDQoNCldoZXJlIM67IGlzIHRoZSB2YXJpYWJsZSBncm93dGggcmF0ZSAoaW4gb3VyIGNhc2UgaXQgd291bGQgYmUgcHVibGljYXRpb24gaW5jcmVhc2UgcmF0ZSksIFQgaXMgYSBudW1iZXIgb2YgdGltZSBzdGVwcyAoaW4gb3VyIGNhc2UgeWVhcnMpIGFuZCBOMCBpcyB0aGUgaW5pdGlhbCB2YWx1ZSBvZiBwdWJsaWNhdGlvbnMuIFdlIGNhbiB0YWtlIGFkdmFudGFnZSBvZiBhIGxvZy1saW5rIHRvIGxpbmVhcml6ZSB0aGUgZXF1YXRpb24gYXM6DQoNCiQkDQpsb2coTl9UKSA9IGxvZyhOXzApICsgbG9nKFxsYW1iZGFee1R9KSBUDQokJA0KDQpXaGljaCBjb21wYXJlZCB0byBhIGdlbmVyaWMgR2VuZXJhbGl6ZWQgTGluZWFyIE1vZGVsIChHTE0pIGVxdWF0aW9uIHdpdGggYSBsb2ctbGluazoNCg0KJCQNCmxvZyh5KSA9IFxiZXRhXzAgKyBcYmV0YV8xeF8xDQokJA0KDQpOb3cgYSBtb2RlbCBlc3RpbWF0ZXMgZm9yIHRoZSBncm93dGggaW4gcHVibGljYXRpb25zIG51bWJlciB0aGF0IGRlcGVuZHMgb24gcHJldmlvdXMgcG9wdWxhdGlvbiBzaXplIGNhbiBiZSBtb2RlbGVkIGFzIGEgcmF0ZToNCg0KJCQNClxmcmFje05fe1QrMX19e05fVH0NCiQkDQoNCldlIGNhbiB1c2UgYSBsb2ctbGluayB0byBsaW5lYXJpemUgdGhpcyByYXRlIHRlcm0gYXM6DQoNCiQkDQpsb2coXGZyYWN7Tl97VCsxfX17Tl9UfSkgPSBcYmV0YV8wDQokJA0KDQokJA0KbG9nKHtOX3tUKzF9fSkgKyBsb2coe05fVH0pID0gXGJldGFfMA0KJCQNCg0KJCQNCmxvZyh7Tl97VCsxfX0pID0gXGJldGFfMCArIGxvZyh7Tl9UfSkNCiQkDQoNClRoZSAkbG9nKE5fVCkkIHRlcm0sIHdoaWNoIGhhcyBubyBjb2VmZmljaWVudCBhc3NvY2lhdGVkIHRvIGl0LCBpcyBhbiBvZmZzZXQgdGhhdCBjYW4gYmUgbW9kZWxlZCBpbnRvIHRoZSBHTE0gaW4gUiBjb2RlIGJ5Og0KDQpgYGB7ciBldmFsPUZBTFNFfQ0KDQptb2RlbCA8LSBnbG0ocmVzcG9uc2UgfiAxLCANCiAgICBvZmZzZXQgPSBsb2cocHJldmlvdXNfbnVtYmVyKSwgDQogICAgZmFtaWx5ID0gcG9pc3NvbihsaW5rID0gImxvZyIpLA0KICAgIGRhdGEgPSBkYXRhKQ0KYGBgDQoNClRoZSBiYWNrLXRyYW5zZm9ybWVkIGludGVyY2VwdCBvZiB0aGUgR0xNIG1vZGVsIGlzIHRoZSB5ZWFybHkgcmF0ZSBvZiBpbmNyZWFzZSAkXGZyYWN7Tl97VCsxfX17Tl9UfSQuIEluIFIgd2UgY2FuIG9idGFpbiBpdCBhczoNCg0KYGBge3IgZXZhbD1GQUxTRX0NCg0KZ3Jvd3RoX3JhdGUgPC0gZXhwKGNvZWYobW9kZWwpKQ0KYGBgDQoNCldoZXJlOg0KDQotICAgYGV4cCgpYCB0cmFuc2Zvcm0gYmFjayB0aGUgZXhwb25lbnRpYWwgcmF0ZTsNCg0KLSAgIGBjb2VmKClgIGV4dHJhY3QgY29lZmZpY2llbnQgcGFyYW1ldGVycyBmcm9tIHRoZSBgbW9kZWxgIGNyZWF0ZWQgdXNpbmcgdGhlIGBnbG1gIGZ1bmN0aW9uIGFib3ZlLg0KDQpUaHVzLCBpZiB0aGVyZSBhcmUgJE4kIHB1YmxpY2F0aW9ucyBmb3IgdGhlIHllYXIgJFQkLCBpZiB3ZSB3YW50IHRvIGtub3cgaG93IG1hbnkgcHVibGljYXRpb25zIGFyZSBpbiB0aGUgZm9sbG93aW5nIHllYXIgJChUKzEpJCB3ZSBqdXN0IG11bHRpcGx5IHRoZSBgZ3Jvd3RoX3JhdGVgIG9idGFpbmVkIGFib3ZlIGJ5IHRoZSBudW1iZXIgb2YgdGhlIHB1YmxpY2F0aW9ucyBmb3IgdGhlIHllYXIgJFQkIG9yLCAkTl9UJDoNCg0KJCQNCkdyb3d0aCByYXRlICogTl9UID0gTl97VCsxfQ0KJCQNCg0KIyMjIFNpZGUgbm90ZQ0KDQpPbiBhIHNpZGUgbm90ZSwgdGhpcyBtb2RlbCBjb3VsZCBiZSBpbXByb3ZlZCBmdXJ0aGVyIGJ5IGludHJvZHVjaW5nIGEgUmlja2VyIG1vZGVsIHRoYXQgYXBwcm94aW1hdGUgYSBsb2dpc3RpYyBncm93dGgsIGJ5IHRha2luZyBpbnRvIGFjY291bnQgYSBjYXJyeWluZyBjYXBhY2l0eSB3aXRoaW4gdGhlIG1vZGVsLCB0aHVzIGFsbG93aW5nIHRoZSBncm93dGggcmF0ZSB0byBjaGFuZ2UgYXMgdGhlIG51bWJlciBvZiBwdWJsaWNhdGlvbnMgaW5jcmVhc2UuIEhvd2V2ZXIsIHRoZXJlIGlzIG5vdCByZWFsbHkgYW55IGV2aWRlbmNlIHRoYXQgdGhpcyBuZWNlc3NhcmlseSB3b3VsZCBvY2N1ciBhbmQgaXMgb3V0IG9mIHRoZSBzY29wZSBvZiB0aGlzIGFuYWx5c2lzLg0KDQojIyBDYWxjdWxhdGluZyB0aGUgUG9pc3NvbiBncm93dGggcmF0ZXMNCg0KYGBge3J9DQoNCnBvaXNfcmF0ZSA8LSBzY2llbnRpZmljX2RhdGEgJT4lIA0KICAgICAgICAgIGdyb3VwX2J5KG5hbWUpICU+JSANCiAgICAgICAgICBmaWx0ZXIoY3VtX3ZhbHVlID4gMCkgJT4lIA0KICAgICAgICAgIG11dGF0ZSh5ZWFyID0gMTpsZW5ndGgoWWVhciksIA0KICAgICAgICAgICAgICAgICBjdW1fdmFsdWVfdCA9IGxhZyhjdW1fdmFsdWUpKSAlPiUgDQogICAgICAgICAgc3BsaXQoLiRuYW1lKSAlPiUNCiAgICAgICAgICBtYXAofmdsbShjdW1fdmFsdWV+MSwgZGF0YSA9IC54LCANCiAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBsb2coY3VtX3ZhbHVlX3QpLA0KICAgICAgICAgICAgICAgICAgIGZhbWlseSA9IHBvaXNzb24obGluayA9ICJsb2ciKSkpICU+JSANCiAgICAgICAgICBtYXBfZGYoYnJvb206OnRpZHksIC5pZCA9ICduYW1lJykgJT4lDQogICAgICAgICAgZmlsdGVyKHRlcm0gIT0gJ3llYXInKSAlPiUgDQogICAgICAgICAgZHBseXI6OnNlbGVjdChDb3VudHJ5ID0gbmFtZSwgUHVibGljYXRpb25zID0gZXN0aW1hdGUpICU+JSANCiAgICAgICAgICBtdXRhdGUocG9pc19yYXRlID0gcm91bmQoZXhwKFB1YmxpY2F0aW9ucyksIDIpKSAlPiUgDQogICAgICAgICAgYXJyYW5nZShwb2lzX3JhdGUpICU+JSANCiAgICAgICAgICBkcGx5cjo6c2VsZWN0KC1QdWJsaWNhdGlvbnMpDQoNCmBgYA0KDQpXaGljaCBnaXZlczoNCg0KYGBge3IgZWNobz1GQUxTRSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRSwgcGFnZWQucHJpbnQ9VFJVRX0NCg0KcG9pc19yYXRlDQoNCmBgYA0KDQpUaGUgZnVuY3Rpb24gY2FsY3VsYXRlZCBhbHNvIFBvaXNzb24gcmF0ZXMgZm9yIGBXb3JsZHdpZGVgIGFuZCBgUmVzdGAgY2F0ZWdvcnkuIFRoZSBmaXJzdCByZXByZXNlbnRzIGFsbCB0aGUgcHVibGljYXRpb25zIGFyb3VuZCB0aGUgd29ybGQsIHdoZXJlYXMgYFJlc3RgIHJlcHJlc2VudHMgYWxsIGJ1dCB0aGUgMTMgY291bnRyaWVzIHB1YmxpY2F0aW9ucy4NCg0KTGV0J3Mgbm93IGpvaW4gdGhlIGdyb3d0aCByYXRlcyB3aXRoIG1hbmdyb3ZlIHN0YXRzIGJ5IGNvdW50cmllcy4NCg0KYGBge3J9DQojIyBKb2luaW5nIHRoZSB0d28gbW9kZWwgcmVzdWx0cyBieSBjb3VudHJ5IG5hbWUNCg0KbV9kYXRhc2V0IDwtIGxlZnRfam9pbihwb2lzX3JhdGUsIG1hbmdyb3Zlc19zdGF0cywgYnkgPSAiQ291bnRyeSIpICU+JSANCiAgICAgICAgICBqYW5pdG9yOjpjbGVhbl9uYW1lcygpICU+JSANCiAgICAgICAgICBmaWx0ZXIoIWNvdW50cnkgJWluJSBjKCJSZXN0IiwgIldvcmxkd2lkZSIpKQ0KDQpnbGltcHNlKG1fZGF0YXNldCkNCg0KYGBgDQoNCmBgYHtyfQ0KbV9kYXRhc2V0MiA8LSBtX2RhdGFzZXQgJT4lIA0KICAgICAgICAgIHBpdm90X2xvbmdlcihtYW5ncm92ZV9jb3ZlcmFnZTp0b3RhbF9hcmVhX2xvc3RfYmV0d2Vlbl8xOTk2X2FuZF8yMDE2KSAlPiUgDQogICAgICAgICAgZmlsdGVyKG5hbWUgJWluJSBjKCJhcmVhX2xvc3RfcGVyX3llYXJfa21fMl95ciIpKSAlPiUgDQogICAgICAgICAgbXV0YXRlKG5hbWUgPSBmYWN0b3IobmFtZSwgbGV2ZWxzID0gYygibWFuZ3JvdmVfY292ZXJhZ2UiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1pdGlnYXRpb25fcG90ZW50aWFsX3BlcmNlbnQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImFyZWFfbG9zdF9wZXJfeWVhcl9rbV8yX3lyIiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gYygiTWFuZ3JvdmUgY292ZXJhZ2UiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk1pdGlnYXRpb24gcG90ZW50aWFsICglKSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQXJlYSBsb3N0IHBlciB5ZWFyIChrbSBzcSkiKSkpDQoNCnBvaXNfcGxvdCA8LSBtX2RhdGFzZXQyICU+JSANCiAgICAgICAgICBnZ3Bsb3QoYWVzKHkgPSBwb2lzX3JhdGUsIHggPSB2YWx1ZSwgbGFiZWwgPSBjb3VudHJ5KSkgKw0KICAgICAgICAgIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIHNlID0gRikgKw0KICAgICAgICAgIGdlb21fc21vb3RoKGRhdGEgPSBtX2RhdGFzZXQyWy1jKDExLDEzKSxdLCANCiAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSAibG0iLCANCiAgICAgICAgICAgICAgICAgICAgICBjb2wgPSAicmVkIiwgDQogICAgICAgICAgICAgICAgICAgICAgc2UgPSBGKSArDQogICAgICAgICAgZ2VvbV9wb2ludCgpICsNCiAgICAgICAgICBnZW9tX3RleHRfcmVwZWwoc2l6ZSA9IDUpICsNCiAgICAgICAgICBsYWJzKHggPSAiQXJlYSBsb3N0IHBlciB5ZWFyIChsb2ctc2NhbGUpIiwNCiAgICAgICAgICAgICAgIHkgPSAiUHVibGljYXRpb24gcmF0ZSBvdmVyIHRpbWUiKSArDQogICAgICAgICAgdGhlbWVfYncoKSArDQogICAgICAgICAgdGhlbWUocGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgICAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpDQogICAgICAgICAgKQ0KDQp0b3RfcHViIDwtIHNjaWVudGlmaWNfZGF0YSAlPiUgDQogICAgICAgICAgZ3JvdXBfYnkobmFtZSkgJT4lIA0KICAgICAgICAgIHN1bW1hcmlzZSh0b3RfcCA9IHN1bSh2YWx1ZSkpICU+JSANCiAgICAgICAgICBmaWx0ZXIoIW5hbWUgJWluJSBjKCJSZXN0IiwgIldvcmxkd2lkZSIpKSAlPiUgDQogICAgICAgICAgc2VsZWN0KENvdW50cnkgPSBuYW1lLCB0b3RfcCkNCg0KY292X21hbmdfdG90IDwtIGxlZnRfam9pbihtYW5ncm92ZXNfc3RhdHMsIHRvdF9wdWIsIGJ5PSJDb3VudHJ5IikNCg0KDQptYW5nX3RvdF9wbG90IDwtIGNvdl9tYW5nX3RvdCAlPiUgDQogICAgICAgICAgc2VsZWN0KENvdW50cnksIGBNYW5ncm92ZSBDb3ZlcmFnZWAsIHRvdF9wKSAlPiUgDQogICAgICAgICAgZ2dwbG90KGFlcyh5PSh0b3RfcCksIHg9KGBNYW5ncm92ZSBDb3ZlcmFnZWApLCBsYWJlbCA9IENvdW50cnkpKSArDQogICAgICAgICAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgDQogICAgICAgICAgICAgICAgICAgICAgc2UgPSBGKSArDQogICAgICAgICAgZ2VvbV9zbW9vdGgoZGF0YSA9IGNvdl9tYW5nX3RvdFstYygxLDEwKSxdLCANCiAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSAibG0iLCANCiAgICAgICAgICAgICAgICAgICAgICBjb2wgPSAicmVkIiwgDQogICAgICAgICAgICAgICAgICAgICAgc2UgPSBGKSArDQogICAgICAgICAgZ2VvbV9wb2ludCgpICsNCiAgICAgICAgICBnZW9tX3RleHRfcmVwZWwoc2l6ZT01KSArDQogICAgICAgICAgbGFicyh4PSJNYW5ncm92ZSBBcmVhIChsb2ctc2NhbGUpIiwgeSA9ICIjIG9mIHB1YmxpY2F0aW9ucyAobG9nLXNjYWxlKSIpICsNCiAgICAgICAgICB0aGVtZV9idygpICsNCiAgICAgICAgICB0aGVtZShwYW5lbC5ncmlkID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgICAgICAgICAgIHN0cmlwLmJhY2tncm91bmQgPSBlbGVtZW50X2JsYW5rKCkgDQogICAgICAgICAgKQ0KYGBgDQoNCk5vdyB3ZSBjYW4gYWxzbyByZXByb2R1Y2UgdGhlIHBsb3QgZm9yIEZpZ3VyZSAxIGluIG1haW4gdGV4dC4NCg0KYGBge3IgbWFpbmZpZywgZmlnLmhlaWdodD04LCBmaWcud2lkdGg9MTAsIGZpZy5jYXA9IlNlZSBjYXB0aW9ucyBpbiBtYWluIHRleHQgZm9yIEZpZ3VyZSAxIn0NCg0KKHB1Yl9wbG90IHwgKG1hbmdfdG90X3Bsb3QgLyBwb2lzX3Bsb3QpKSArDQogICAgICAgICAgcGxvdF9hbm5vdGF0aW9uKHRhZ19sZXZlbHMgPSAiYSIpICYNCiAgICAgICAgICB0aGVtZShwbG90LnRhZyA9IGVsZW1lbnRfdGV4dChmYWNlID0gJ2JvbGQnKSkNCg0KYGBgDQoNCiMjIFB1YmxpY2F0aW9uIHJhdGVzICp2cyogbWFuZ3JvdmUgc3RhdHMNCg0KTm93IHRoYXQgd2UgY2FsY3VsYXRlZCBwdWJsaWNhdGlvbiByYXRlcywgd2Ugd2FudCB0byBzZWUgd2l0aGluIHRoZSAxMyBjb3VudHJpZXMgd2l0aCBtb3N0IG1hbmdyb3ZlcywgaWYgdGhlcmUgaXMgYW55IHJlbGF0aW9uc2hpcCBiZXR3ZWVuOg0KDQoxLiAgKipUaGUgbnVtYmVyIG9mIHB1YmxpY2F0aW9ucyB3aXRoaW4gZWFjaCBjb3VudHJ5IHdpdGggdGhlIHRvdGFsIG1hbmdyb3ZlIGFyZWEqKi4gQXMgaHlwb3RoZXNpcywgd2Ugd2FudGVkIHRvIHRlc3QgaWYgYSBsYXJnZXIgbWFuZ3JvdmUgYXJlYSBleHRlbnQgd2FzIHJlbGF0ZWQgdG8gdGhlIG51bWJlciBvZiBwdWJsaWNhdGlvbnMgaW4gYSBjb3VudHJ5Lg0KDQoyLiAgKipUaGUgcmF0ZSBvZiBwdWJsaWNhdGlvbnMgb3ZlciB0aW1lIHdpdGhpbiBlYWNoIGNvdW50cnkgd2l0aCB0aGUgcmF0ZSBvZiBtYW5ncm92ZSBhcmVhIGxvc3Mgb3ZlciB0aW1lKiouIEFzIGh5cG90aGVzaXMsIHdlIHdhbnRlZCB0byB0ZXN0IGlmIGEgaGlnaGVyIHJhdGUgb2YgbWFuZ3JvdmUgbG9zcyB3YXMgcmVsYXRlZCB0byBhIGhpZ2hlciByYXRlIG9mIHNjaWVudGlmaWMgcHVibGljYXRpb25zLg0KDQpUbyB0ZXN0IHRoZXNlIHR3byBoeXBvdGhlc2lzIHdlIHVzZWQgT3JkaW5hcnkgTGVhc3QgU3F1YXJlIChPTFMpIG1vZGVscy4NCg0KIyMjIE51bWJlciBvZiBwdWJsaWNhdGlvbnMgdnMgdG90YWwgbWFuZ3JvdmUgYXJlYQ0KDQpGaXJzdCwgbGV0J3Mgc2VlIGFnYWluIGhvdyB0aGV5IGxvb2sgbGlrZS4NCg0KYGBge3IgbnVtUHViQXJlYSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRSwgZmlnLmNhcHRpb24gPSAiTnVtYmVyIG9mIHB1YmxpY2F0aW9ucyBjb21wYXJlZCB0byB0b3RhbCBtYW5ncm92ZSBhcmVhIn0NCiMgUHJlcGFyaW5nIGRhdGEgdG8gYmUgbW9kZWxlZA0KdG9tb2RlbCA8LSBjb3ZfbWFuZ190b3QgJT4lIA0KICAgICAgICAgIHNlbGVjdChjb3VudHJ5ID0gQ291bnRyeSwgDQogICAgICAgICAgICAgICAgIG1hbmdfY292ZXIgPSBgTWFuZ3JvdmUgQ292ZXJhZ2VgLCANCiAgICAgICAgICAgICAgICAgdG90X3ApDQoNCiMgUGxvdHRpbmcNCmdncGxvdCh0b21vZGVsLCBhZXMoeCA9IChtYW5nX2NvdmVyKSwgDQogICAgICAgICAgICAgICAgICAgIHkgPSAodG90X3ApLCANCiAgICAgICAgICAgICAgICAgICAgbGFiZWwgPSBjb3VudHJ5KSkgKw0KICAgICAgICAgIGdlb21fcG9pbnQoKSArDQogICAgICAgICAgZ2VvbV90ZXh0X3JlcGVsKHNpemU9NSkgKw0KICAgICAgICAgIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIHNlID0gRikgKw0KICAgICAgICAgIGxhYnMoeD0iTWFuZ3JvdmUgY292ZXIiLCB5PSJUb3RhbCBudW1iZXIgb2YgcHVibGljYXRpb25zIikgKw0KICAgICAgICAgIHRoZW1lX2J3KCkgKw0KICAgICAgICAgIHRoZW1lKHBhbmVsLmdyaWQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgICAgICAgICAgc3RyaXAuYmFja2dyb3VuZCA9IGVsZW1lbnRfYmxhbmsoKSANCiAgICAgICAgICApDQoNCmBgYA0KDQpXZSBjYW4gY2xlYXJseSBzZWUgdGhhdCB0aGVyZSBhcmUgc29tZSBjb3VudHJpZXMgdGhhdCBkbyBub3QgY29uZm9ybSB0byBhIGxpbmVhciByZWxhdGlvbnNoaXAuDQoNCmBgYHtyfQ0KDQptb2QxIDwtIGxtKHRvdF9wIH4gbWFuZ19jb3ZlciwgZGF0YSA9IHRvbW9kZWwpDQoNCnN1bW1hcnkobW9kMSkNCg0KYGBgDQoNClRoZSBtb2RlbCBgbW9kMWAgZXhwbGFpbnMgYSBzdGF0aXN0aWNhbGx5ICoqbm90Kiogc2lnbmlmaWNhbnQgYW5kIGFuZCB3ZWFrIHByb3BvcnRpb24gb2YgdmFyaWFuY2UgKCRSXjIkID0gMC4wMiwgJEYkKDEsIDExKSA9IDAuMjUsICRwJCA9IDAuNjI3LCBhZGouICRSXjIkID0gLTAuMDcpLiBUaGUgZWZmZWN0IG9mIHRoZSBtYW5ncm92ZSBjb3ZlciBvbiB0aGUgbnVtYmVyIG9mIHB1YmxpY2F0aW9ucyBpcyBzdGF0aXN0aWNhbGx5IG5vbi1zaWduaWZpY2FudCBhbmQgcG9zaXRpdmUgKCRcYmV0YSQgPSAkOS43NCoxMF57LTN9JCwgOTUlICRDSSQgWy0wLjAzLCAwLjA1XSwgJHQkKDExKSA9IDAuNTAsICRwJCA9IDAuNjI3OyBTdGQuICRcYmV0YSQgPSAwLjE1LCA5NSUgJENJJCBbLTAuNTEsIDAuODFdKS4NCg0KYGBge3IgcmVzTW9kMSwgZmlnLmNhcD0iUmVzaWR1YWxzIG9mIHRoZSBmdWxsIG1vZGVsIiwgZmlnLnNob3cgPSAiaG9sZCJ9DQoNCnBhcihtZnJvdyA9IGMoMiwyKSkNCnBsb3QobW9kMSkNCnBhcihtZnJvdyA9IGMoMSwxKSkNCg0KYGBgDQoNClRoZSByZWFzb24gZm9yIHRoaXMgcG9vciBmaXR0aW5nIGlzIGNhdXNlZCBieSB0aGUgaW5mbHVlbmNlIG9mIHR3byBjb3VudHJpZXM6IEluZGlhIGFuZCBJbmRvbmVzaWEuIFRoZXNlIHR3byBjb3VudHJpZXMgaGF2ZSBtdWNoIGhpZ2hlciBwdWJsaWNhdGlvbnMgcmVsYXRpdmUgdG8gbWFuZ3JvdmUgYXJlYXMgY29tcGFyZWQgdG8gb3RoZXIgY291bnRyaWVzLCBhbmQgSW5kb25lc2lhIGhhdmUgbXVjaCBoaWdoZXIgbWFuZ3JvdmUgYXJlYSByZWxhdGl2ZSB0byBwdWJsaWNhdGlvbiBudW1iZXIuIFRoZXNlIHR3byBjb3VudHJpZXMgYXJlIHNwZWNpYWwgY2FzZXMsIHRoYXQgaWYgcmVtb3ZlZCBmcm9tIHRoZSBtb2RlbCByZXN1bHRzIGluIGEgc2lnbmlmaWNhbnQgcmVsYXRpb25zaGlwIGJldHdlZW4gdGhlIG51bWJlciBvZiBwdWJsaWNhdGlvbnMgYW5kIHRvdGFsIG1hbmdyb3ZlIGFyZWEgYXMgd2Ugc2VlIGluIHRoZSBuZXh0IGdyYXBocy4NCg0KYGBge3J9DQoNCm1vZDIgPC0gbG0odG90X3AgfiBtYW5nX2NvdmVyLCBkYXRhID0gdG9tb2RlbFstYygxLDEwKSxdKQ0KDQpzdW1tYXJ5KG1vZDIpDQoNCg0KYGBgDQoNCkFzIHdlIGNhbiBzZWUgZnJvbSB0aGUgc3VtbWFyeSBvZiB0aGUgc2Vjb25kIG1vZGVsIHdpdGhvdXQgSW5kaWEgYW5kIEluZG9uZXNpYSwgYG1vZDJgLCB0aGUgbW9kZWwgZXhwbGFpbnMgYSAqKnN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQqKiBhbmQgc3Vic3RhbnRpYWwgcHJvcG9ydGlvbiBvZiB2YXJpYW5jZSAoJFJeMiQgPSAwLjY4LCAkRiQoMSwgOSkgPSAxOS41MywgJHAkID0gMC4wMDIsIGFkai4gJFJeMiQgPSAwLjY1KS4gVGhlIGVmZmVjdCBvZiBtYW5ncm92ZSBjb3ZlciBvdmVyIHRoZSBudW1iZXIgb2YgcHVibGljYXRpb25zIGlzIG5vdyBzaWduaWZpY2FudCBhbmQgcG9zaXRpdmUgKCRcYmV0YSQgPSAwLjEwLCA5NSUgJENJJCBbMC4wNSwgMC4xNV0sICR0JCg5KSA9IDQuNDIsICRwJCA9IDAuMDAyOyBTdGQuICRcYmV0YSQgPSAwLjgzLCA5NSUgJENJJCBbMC40MCwgMS4yNV0pLg0KDQpgYGB7ciBwbG90Y291bnRyeXRvdH0NCg0KcDEgPC0gZ2dwbG90KHRvbW9kZWxbLWMoMSwxMCksXSwgYWVzKHggPSBtYW5nX2NvdmVyLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gdG90X3AsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsID0gY291bnRyeSkpICsNCiAgICAgICAgICBnZW9tX3BvaW50KCkgKw0KICAgICAgICAgIGdlb21fdGV4dF9yZXBlbChzaXplID0gNSkgKw0KICAgICAgICAgIGxhYnMoeD0iTWFuZ3JvdmUgY292ZXIiLCB5PSAiVG90YWwgTnVtYmVyIG9mIFB1YmxpY2F0aW9ucyIsIA0KICAgICAgICAgICAgICAgdGl0bGU9IldpdGhvdXQgSW5kaWEgYW5kIEluZG9uZXNpYSIpICsgDQogICAgICAgICAgZ2VvbV9zbW9vdGgoZGF0YSA9IHRvbW9kZWxbLWMoMSwxMCksXSwgbWV0aG9kID0gImxtIiwgZm9ybXVsYSA9IHkgfiB4KSArDQogICAgICAgICAgdGhlbWVfYncoKSArDQogICAgICAgICAgdGhlbWUocGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgICAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpDQogICAgICAgICAgKQ0KDQpwMiA8LSBnZ3Bsb3QodG9tb2RlbCwgYWVzKHggPSBtYW5nX2NvdmVyLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gdG90X3AsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsID0gY291bnRyeSkpICsNCiAgICAgICAgICBnZW9tX3BvaW50KCkgKw0KICAgICAgICAgIGdlb21fdGV4dF9yZXBlbChzaXplID0gNSkgKw0KICAgICAgICAgIGxhYnMoeD0iTWFuZ3JvdmUgY292ZXIiLCB5PSAiVG90YWwgTnVtYmVyIG9mIFB1YmxpY2F0aW9ucyIsIA0KICAgICAgICAgICAgICAgdGl0bGU9IldpdGggSW5kaWEgYW5kIEluZG9uZXNpYSIpICsgDQogICAgICAgICAgZ2VvbV9zbW9vdGgoZGF0YSA9IHRvbW9kZWxbLWMoMSwxMCksXSwgbWV0aG9kID0gImxtIiwgZm9ybXVsYSA9IHkgfiB4KSArDQogICAgICAgICAgdGhlbWVfYncoKSArDQogICAgICAgICAgdGhlbWUocGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgICAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpDQogICAgICAgICAgKQ0KDQoNCnAxK3AyICsgcGxvdF9hbm5vdGF0aW9uKHRhZ19sZXZlbHMgPSAiQSIpDQpgYGANCg0KIyMjIFJhdGUgb2YgcHVibGljYXRpb25zICp2cyogcmF0ZSBvZiBtYW5ncm92ZSBhcmVhIGxvc3MNCg0KU2ltaWxhcmx5LCB3ZSB3YW50ZWQgdG8gZXhwbG9yZSB0aGUgcmVsYXRpb25zaGlwcyBiZXR3ZWVuIHRoZSByYXRlIG9mIHB1YmxpY2F0aW9ucyBhbmQgdGhlIHJhdGUgb2YgbWFuZ3JvdmUgYXJlYSBsb3NzIG92ZXIgdGhlIHllYXJzLiBXZSB1c2VkIGEgc2ltaWxhciBhcHByb2FjaCBzaG93ZWQgaW4gU2VjdGlvbiBcQHJlZihudW1iZXItb2YtcHVibGljYXRpb25zLXZzLXRvdGFsLW1hbmdyb3ZlLWFyZWEpLg0KDQpgYGB7ciByYXRlcHViLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFLCBmaWcuY2FwID0gIkdyb3d0aCByYXRlIG9mIHB1YmxpY2F0aW9ucyBjb21wYXJlZCB0byB0aGUgcmF0ZSBvZiBtYW5ncm92ZSBhcmVhIGxvc3Mgb3ZlciB0aGUgeWVhcnMifQ0KDQp0b21vZGVsIDwtIG1fZGF0YXNldCAlPiUgDQogICAgICAgICAgcGl2b3RfbG9uZ2VyKG1hbmdyb3ZlX2NvdmVyYWdlOnRvdGFsX2FyZWFfbG9zdF9iZXR3ZWVuXzE5OTZfYW5kXzIwMTYpICU+JSANCiAgICAgICAgICBmaWx0ZXIobmFtZSAlaW4lIGMoIm1hbmdyb3ZlX2NvdmVyYWdlIikpICU+JSANCiAgICAgICAgICBzZWxlY3QoYXJlYV9sb3N0ID0gdmFsdWUsIHBvaXNfcmF0ZSwgY291bnRyeSkNCg0KDQpnZ3Bsb3QodG9tb2RlbCwgYWVzKHggPSBhcmVhX2xvc3QsIHkgPSBwb2lzX3JhdGUsIGxhYmVsID0gY291bnRyeSkpICsNCiAgICAgICAgICBnZW9tX3BvaW50KCkgKw0KICAgICAgICAgIGdlb21fdGV4dF9yZXBlbChzaXplID0gNSkgKw0KICAgICAgICAgIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIpICsNCiAgICAgICAgICBsYWJzKHg9Ik1hbmdyb3ZlIGxvc3MgcGVyIHllYXIgKGFyZWEpIiwgeT0gIlB1YmxpY2F0aW9ucyBncm93dGggcmF0ZSIpICsNCiAgICAgICAgICB0aGVtZV9idygpICsNCiAgICAgICAgICB0aGVtZShwYW5lbC5ncmlkID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgICAgICAgICAgIHN0cmlwLmJhY2tncm91bmQgPSBlbGVtZW50X2JsYW5rKCkNCiAgICAgICAgICApDQoNCmBgYA0KDQpGcm9tIHRoZSBwbG90IGluIEZpZ3VyZSBcQHJlZihmaWc6cmF0ZXB1YiksIHdlIGNhbiBzZWUgdGhhdCBhIGxvdCBvZiB0aGUgcmVsYXRpb25zaGlwIGlzIGRyYXduIGJ5IEluZG9uZXNpYS4gTXlhbm1hciBhbmQgQmFuZ2xhZGVzaCBoYXZlIGEgbXVjaCBoaWdoZXIgcmF0ZSBvZiBwdWJsaWNhdGlvbnMgY29tcGFyZWQgdG8gb3RoZXIgY291bnRyaWVzLiBMZXQncyBmaXQgdGhlIGxpbmVhciBtb2RlbCB0byBzZWUgdGhlIHJlc3VsdHMuDQoNCmBgYHtyfQ0KbW9kMyA8LSBsbShwb2lzX3JhdGUgfiBhcmVhX2xvc3QsIGRhdGEgPSB0b21vZGVsKQ0KDQpzdW1tYXJ5KG1vZDMpDQoNCmBgYA0KDQpUaGUgcmVsYXRpb25zaGlwIGlzIG5vdCBzaWduaWZpY2FudCwgYW5kIEJhbmdsYWRlc2ggKDExKSwgSW5kb25lc2lhICgxMiksIGFuZCBNeWFubWFyICgxMyksIGFzIGV4cGVjdGVkIHNob3cgc29tZSBpc3N1ZXMgaW4gdGhlIG1vZGVsIGNoZWNrIHBsb3RzIGluIEZpZ3VyZSBcQHJlZihmaWc6cmVzaWR1YWxzbW9kMykuDQoNCmBgYHtyIHJlc2lkdWFsc21vZDMsIGZpZy5jYXA9IlJlc2lkdWFscyBvZiB0aGUgZnVsbCBtb2RlbCIsIGZpZy5zaG93ID0gImhvbGQifQ0KDQpwYXIobWZyb3cgPSBjKDIsMikpDQpwbG90KG1vZDMpDQpwYXIobWZyb3cgPSBjKDEsMSkpDQoNCmBgYA0KDQpJZiB3ZSByZW1vdmUgTXlhbm1hciBhbmQgQmFuZ2xhZGVzaDoNCg0KYGBge3J9DQptb2QyIDwtIGxtKHBvaXNfcmF0ZSB+IGFyZWFfbG9zdCwgZGF0YSA9IHRvbW9kZWxbLWMoMTEsIDEzKSxdKQ0Kc3VtbWFyeShtb2QyKQ0KDQpgYGANCg0KVGhlIG1vZGVsIGV4cGxhaW5zIGEgKipzdGF0aXN0aWNhbGx5IHNpZ25pZmljYW50KiogYW5kIHN1YnN0YW50aWFsIHByb3BvcnRpb24gb2YgdmFyaWFuY2UgKCRSXjIkID0gMC41NiwgJEYkKDEsIDkpID0gMTEuNTksICRwJCA9IDAuMDA4LCBhZGouICRSXjIkID0gMC41MSkuIFRoZSBlZmZlY3Qgb2YgdGhlIHJhdGUgb2YgYXJlYSBsb3N0IGZvciB0aGlzIHNldCBvZiBjb3VudHJpZXMgaW4gdGhlIHJhdGUgb2YgcHVibGljYXRpb25zIGlzIHN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQgYW5kIHBvc2l0aXZlICgkXGJldGEkID0gNS4yNGUtMDYsIDk1JSAkQ0kkIFsxLjc2ZS0wNiwgOC43M2UtMDZdLCAkdCQoOSkgPSAzLjQwLCAkcCQgPSAwLjAwODsgU3RkLiAkXGJldGEkID0gMC43NSwgOTUlICRDSSQgWzAuMjUsIDEuMjVdKS4NCg0KV2h5IE15YW5tYXIgYW5kIEJhbmdsYWRlc2ggYXJlIHNvIGRpZmZlcmVudCBmcm9tIHRoZSByZXN0Pw0KDQpgYGB7ciBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFLCBwYWdlZC5wcmludD1UUlVFfQ0KIyB3aHkgc2hvdWxkIHdlIHJlbW92ZSBNeWFubWFyIGFuZCBCYW5nbGFkZXNoPw0KDQpzY2llbnRpZmljX2RhdGEgJT4lIA0KICAgICAgICAgIGdyb3VwX2J5KG5hbWUpICU+JSANCiAgICAgICAgICBmaWx0ZXIoY3VtX3ZhbHVlID4gMCkgJT4lIA0KICAgICAgICAgIGNvdW50KCkgJT4lIA0KICAgICAgICAgIGFycmFuZ2UoLW4pDQoNCmBgYA0KDQpUaGV5IGRpZmZlciBmb3IgaGF2aW5nIGEgdmVyeSBoaWdoIHJhdGUgb2YgcHVibGljYXRpb25zLCB3aGVyZSB0aGUgbnVtYmVyIG9mIHB1YmxpY2F0aW9ucyBpbmNyZWFzZWQgcmFwaWRseSBpbiBtb3JlIHJlY2VudCB5ZWFycywgYW5kIGJ5IGhhdmluZyBhIHNtYWxsZXIgYXJlYSBsb3N0IHBlciB5ZWFyIHJhdGUgdGhhbiBvdGhlciBjb3VudHJpZXMgd2l0aCBzaW1pbGFyIHJhdGVzIG9mIHB1YmxpY2F0aW9ucy4NCg0KSG93ZXZlciwgaWYgd2Ugc2VlIGFnYWluIEZpZ3VyZSBcQHJlZihmaWc6cmVzaWR1YWxzbW9kMyksIEluZG9uZXNpYSwgdGhlIENvb2sncyBkaXN0YW5jZSBpcyBsYXJnZSBlbm91Z2ggdG8gY29uc2lkZXIgaXQgYXMgYW4gb3V0bGllci4gSWYgd2Ugb25seSByZW1vdmUgSW5kb25lc2lhLCB0aGUgcmVsYXRpb25zaGlwIGlzIGNsZWFybHkgbXVjaCBkaWZmZXJlbnQgYW5kIG5vdCBzaWduaWZpY2FudCAoRmlndXJlIFxAcmVmKGZpZzpmaW5hbGZpZ3BvaXMpDQoNCmBgYHtyIGZpbmFsZmlncG9pcywgZmlnLmNhcD0iQSkgUmVsYXRpb25zaGlwIHdpdGhvdXRoIE15YW5tYXIgYW5kIEJhbmdsYWRlcyBpcyBzaWduaWZpY2FudDsgQikgUmVsYXRpb25zaGlwIHdpdGhvdXQgSW5kb25lc2lhIGlzIGNsZWFybHkgbXVjaCBkaWZmZXJlbnQgYW5kIG5vdCBzaWduaWZpY2FudDsgQykgUmVsYXRpb25zaGlwIHdpdGhvdXQgdGhlIHRocmVlIGNvdW50cmllcyBpcyBzdGlsbCBub3Qgc2lnbmZpY2FudDsgRCkgcmVsYXRpb25zaGlwIHdpdGggYWxsIGNvdW50cmllcy4ifQ0KDQpwMSA8LSBnZ3Bsb3QodG9tb2RlbFstYygxMSwxMyksXSwgYWVzKHggPSBhcmVhX2xvc3QsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBwb2lzX3JhdGUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsID0gY291bnRyeSkpICsNCiAgICAgICAgICBnZW9tX3BvaW50KCkgKw0KICAgICAgICAgIGdlb21fdGV4dF9yZXBlbChzaXplID0gNSkgKw0KICAgICAgICAgIGxhYnMoeD0iTWFuZ3JvdmUgbG9zcyBwZXIgeWVhciAoYXJlYSkiLCANCiAgICAgICAgICAgICAgIHk9ICJQdWJsaWNhdGlvbnMgZ3Jvd3RoIHJhdGUiLCANCiAgICAgICAgICAgICAgIHRpdGxlPSJXaXRob3V0IE15YW5tYXIgYW5kIEJhbmdsYWRlc2ggKHNpZ25pZmljYW50KSIpICsgDQogICAgICAgICAgZ2VvbV9zbW9vdGgoZGF0YSA9IHRvbW9kZWxbLWMoMTEsMTMpLF0sIA0KICAgICAgICAgICAgICAgICAgICAgIGNvbCA9ICJyZWQiLCANCiAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSAibG0iLA0KICAgICAgICAgICAgICAgICAgICAgIGZvcm11bGEgPSB5IH4geCkgKw0KICAgICAgICAgIHRoZW1lX2J3KCkgKw0KICAgICAgICAgIHRoZW1lKHBhbmVsLmdyaWQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgICAgICAgICAgc3RyaXAuYmFja2dyb3VuZCA9IGVsZW1lbnRfYmxhbmsoKQ0KICAgICAgICAgICkNCg0KcDIgPC0gZ2dwbG90KHRvbW9kZWxbLWMoMTIpLF0sIGFlcyh4ID0gYXJlYV9sb3N0LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gcG9pc19yYXRlLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IGNvdW50cnkpKSArDQogICAgICAgICAgZ2VvbV9wb2ludCgpICsNCiAgICAgICAgICBnZW9tX3RleHRfcmVwZWwoc2l6ZSA9IDUpICsNCiAgICAgICAgICBsYWJzKHg9Ik1hbmdyb3ZlIGxvc3MgcGVyIHllYXIgKGFyZWEpIiwgDQogICAgICAgICAgICAgICB5PSAiUHVibGljYXRpb25zIGdyb3d0aCByYXRlIiwgDQogICAgICAgICAgICAgICB0aXRsZT0iV2l0aG91dCBJbmRvbmVzaWEiKSArIA0KICAgICAgICAgIGdlb21fc21vb3RoKGRhdGEgPSB0b21vZGVsWy1jKDEyKSxdLCANCiAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSAibG0iLCANCiAgICAgICAgICAgICAgICAgICAgICBmb3JtdWxhID0geSB+IHgpICsNCiAgICAgICAgICB0aGVtZV9idygpICsNCiAgICAgICAgICB0aGVtZShwYW5lbC5ncmlkID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgICAgICAgICAgIHN0cmlwLmJhY2tncm91bmQgPSBlbGVtZW50X2JsYW5rKCkNCiAgICAgICAgICApDQoNCnAzIDwtIGdncGxvdCh0b21vZGVsWy1jKDExLDEyLDEzKSxdLCBhZXMoeCA9IGFyZWFfbG9zdCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IHBvaXNfcmF0ZSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWwgPSBjb3VudHJ5KSkgKw0KICAgICAgICAgIGdlb21fcG9pbnQoKSArDQogICAgICAgICAgZ2VvbV90ZXh0X3JlcGVsKHNpemUgPSA1KSArDQogICAgICAgICAgbGFicyh4PSJNYW5ncm92ZSBsb3NzIHBlciB5ZWFyIChhcmVhKSIsIA0KICAgICAgICAgICAgICAgeT0gIlB1YmxpY2F0aW9ucyBncm93dGggcmF0ZSIsIA0KICAgICAgICAgICAgICAgdGl0bGU9IldpdGhvdXQgTXlhbm1hciwgQmFuZ2xhZGVzaCwgYW5kIEluZG9uZXNpYSIpICsgDQogICAgICAgICAgZ2VvbV9zbW9vdGgoZGF0YSA9IHRvbW9kZWxbLWMoMTEsIDEyLCAxMyksXSwgDQogICAgICAgICAgICAgICAgICAgICAgbWV0aG9kID0gImxtIiwgDQogICAgICAgICAgICAgICAgICAgICAgZm9ybXVsYSA9IHkgfiB4KSArDQogICAgICAgICAgdGhlbWVfYncoKSArDQogICAgICAgICAgdGhlbWUocGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgICAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpDQogICAgICAgICAgKQ0KDQpwNCA8LSBnZ3Bsb3QodG9tb2RlbCwgYWVzKHggPSBhcmVhX2xvc3QsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBwb2lzX3JhdGUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsID0gY291bnRyeSkpICsNCiAgICAgICAgICBnZW9tX3BvaW50KCkgKw0KICAgICAgICAgIGdlb21fdGV4dF9yZXBlbChzaXplID0gNSkgKw0KICAgICAgICAgIGxhYnMoeD0iTWFuZ3JvdmUgbG9zcyBwZXIgeWVhciAoYXJlYSkiLCANCiAgICAgICAgICAgICAgIHk9ICJQdWJsaWNhdGlvbnMgZ3Jvd3RoIHJhdGUiLCANCiAgICAgICAgICAgICAgIHRpdGxlPSJBbGwgY291bnRyaWVzIikgKyANCiAgICAgICAgICBnZW9tX3Ntb290aChkYXRhID0gdG9tb2RlbCwgDQogICAgICAgICAgICAgICAgICAgICAgbWV0aG9kID0gImxtIiwgDQogICAgICAgICAgICAgICAgICAgICAgZm9ybXVsYSA9IHkgfiB4KSArDQogICAgICAgICAgdGhlbWVfYncoKSArDQogICAgICAgICAgdGhlbWUocGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgICAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpDQogICAgICAgICAgKQ0KDQoNCihwMStwMikvKHAzK3A0KSArIHBsb3RfYW5ub3RhdGlvbih0YWdfbGV2ZWxzID0gIkEiKQ0KDQpgYGANCg0KIyBOYXRpb25hbCBEZXRlcm1pbmFudCBDb250cmlidXRpb25zIHJlbGF0aW9uc2hpcA0KDQpXZSB0aGVuIHRlc3RlZCB0byBzZWUgaWYgdGhpcyBrbm93bGVkZ2UgYW5kIGF3YXJlbmVzcyB0cmFuc2xhdGVkIGludG8gcm9idXN0IHBvbGljeSBjb21taXRtZW50cyBieSBldmFsdWF0aW5nIE5hdGlvbmFsIERldGVybWluYW50IENvbnRyaWJ1dGlvbnMgKE5EQ3MpIHVuZGVyIHRoZSBQYXJpcyBBZ3JlZW1lbnQgb2YgdGhlIDEzIG1vc3QgbWFuZ3JvdmUtcmljaCBjb3VudHJpZXMuDQoNCldlIGFuYWx5emVkIGlmIE5EQ3MgYWRkcmVzc2VkOg0KDQoxLiAgbWFuZ3JvdmVzIGFzIG1lY2hhbmlzbXMgZm9yIGNsaW1hdGUgYWRhcHRhdGlvbiBvciBtaXRpZ2F0aW9uOw0KDQoyLiAgcHJpb3JpdGl6YXRpb24gb2YgbWFuZ3JvdmUgY29uc2VydmF0aW9uIGFuZCByZXN0b3JhdGlvbjsNCg0KMy4gIHNhZmVndWFyZGluZyBhZ2FpbnN0IGRlZm9yZXN0YXRpb24uDQoNCldlIGFsc28gbm90ZWQgaWYgTkRDcyByZXNwb25kZWQgdG8gY2FsbHMgZm9yIGVjb3N5c3RlbSBtb25pdG9yaW5nLiBUaGlzIGV2YWx1YXRpb24gd2FzIGRvbmUgYnkgcGVyZm9ybWluZyBhIHRleHQtYmFzZWQgYW5hbHlzaXMgb2YgZWFjaCBjb3VudHJ5J3MgMjAxNSBhbmQgMjAyMCBzdWJtaXR0ZWQgTkRDcy4gVGhlIE5EQ3Mgd2VyZSBzY29yZWQgYmFzZWQgb24gaWYgbWFuZ3JvdmVzIHdlcmUgaW5jbHVkZWQgaW4gdGhlaXIgTkRDIGFuZCB0aGUgbGV2ZWwgb2YgY29tbWl0bWVudCB0byBtYW5ncm92ZSBjb25zZXJ2YXRpb24gKFRhYmxlIDEgaW4gbWFpbiB0ZXh0KS4gQ291bnRyaWVzIGNvdWxkIHNjb3JlIGEgbWF4aW11bSBvZiAxNSBwb2ludHMgcGVyIE5EQywgZm9yIGEgdG90YWwgb2YgMzAgcG9pbnRzIGlmIHRoZXkgc3VibWl0dGVkIGJvdGggYSAyMDE1IGFuZCAyMDIwIE5EQy4gSWYgYW4gTkRDIHdhcyBub3Qgc3VibWl0dGVkLCB0aGUgc2NvcmUgIjAiIHdhcyBhc3NpZ25lZC4NCg0KVGhlbiwgd2UgY29tcGFyZWQgdGhlIHJhdGVzIG9mIHB1YmxpY2F0aW9uIGFnYWluc3QgdGhlIGRpZmZlcmVuY2UgaW4gMjAxNSBhbmQgMjAyMCBOREMgc2NvcmVzICgyMDIwIE5EQyBzY29yZSAtIDIwMTUgTkRDIHNjb3JlKS4gQSBwb3NpdGl2ZSBkaWZmZXJlbmNlIGluIE5EQyBzY29yZXMgcmVmbGVjdHMgdGhhdCAyMDIwIE5EQ3MgaGF2ZSBoaWdoZXIgbGV2ZWxzIG9mIGNvbW1pdG1lbnQgdG8gbWFuZ3JvdmUgY29uc2VydmF0aW9uIHRoYW4gaW4gMjAxNSwgd2hpbGUgYSBuZWdhdGl2ZSBkaWZmZXJlbmNlIHN1Z2dlc3RzIHRoYXQgY29tbWl0bWVudCBsZXZlbHMgdG8gbWFuZ3JvdmVzIGRlY3JlYXNlZCBmcm9tIDIwMTUgdG8gMjAyMC4gV2UgaHlwb3RoZXNpemVkIHRoYXQgaGlnaGVyIHJhdGVzIG9mIHB1YmxpY2F0aW9uIHdvdWxkIHBvc2l0aXZlbHkgY29ycmVsYXRlIHdpdGggaGlnaGVyIGRpZmZlcmVuY2VzIGluIE5EQyBzY29yZXMsIGluZGljYXRpbmcgYSByZWxhdGlvbnNoaXAgYmV0d2VlbiBncm93aW5nIHNjaWVudGlmaWMga25vd2xlZGdlIGFuZCBncmVhdGVyIGxldmVsIG9mIHBvbGljeSBjb21taXRtZW50cy4gSW5zdGVhZCwgd2UgZm91bmQgYSBzdHJvbmcgbmVnYXRpdmUgY29ycmVsYXRpb24gYmV0d2VlbiB0aGUgdHdvIGZhY3RvcnMsIGluIHRoYXQgaGlnaGVyIHB1YmxpY2F0aW9uIHJhdGVzIGNvcnJlbGF0ZWQgd2l0aCBsb3dlciBkaWZmZXJlbmNlcyBpbiBOREMgc2NvcmVzLiBUaGlzIHJlc3VsdCBzdWdnZXN0cyB0aGF0IHdoaWxlIHNjaWVudGlmaWMga25vd2xlZGdlIGlzIGJlaW5nIGdlbmVyYXRlZCwgdGhpcyBrbm93bGVkZ2UgaXMgbm90IG5lY2Vzc2FyaWx5IHRyYW5zbGF0aW5nIGludG8gcG9saWN5IGFjdGlvbiBhbmQgaW1wcm92ZWQgY29tbWl0bWVudHMgZm9yIG1hbmdyb3ZlIGNvbnNlcnZhdGlvbi4NCg0KYGBge3J9DQojIE5EQ3MgZ3JhcGggLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KTkRDcyA8LSBtZXJnZShORENzLCBwb2lzX3JhdGUsIGJ5ID0gIkNvdW50cnkiKQ0KDQpnZ3Bsb3QoTkRDcywgDQogICAgICAgYWVzKHggPSBwb2lzX3JhdGUsIA0KICAgICAgICAgICB5ID0gRGlmZmVyZW5jZSwNCiAgICAgICAgICAgbGFiZWwgPSBDb3VudHJ5KSkgKw0KICAgICAgICAgIGdlb21fcG9pbnQoKSArDQogICAgICAgICAgZ2VvbV90ZXh0X3JlcGVsKCkgKw0KICAgICAgICAgIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIHNlID0gRiwgY29sID0gInJlZCIpICsNCiAgICAgICAgICB0aGVtZV9idygpICsNCiAgICAgICAgICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAwKSArDQogICAgICAgICAgdGhlbWUocGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgICAgICAgICBheGlzLmxpbmUueSA9IGVsZW1lbnRfbGluZSgpLA0KICAgICAgICAgICAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJ0b3AiKQ0KDQpgYGANCg0KVGhlIG1vZGVsIGFib3ZlIGlzICoqc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCoqIGFuZCBleHBsYWlucyBzdWJzdGFudGlhbCBwcm9wb3J0aW9uIG9mIHZhcmlhbmNlICgkUl4yJCA9IDAuNjUsICRGJCgxLCAxMSkgPSAyMC4zMiwgJHAkIFw8IC4wMDEsIGFkai4gJFJeMiQgPSAwLjYyKS4gVGhlIGVmZmVjdCBvZiB0aGUgcmF0ZSBvZiBwdWJsaWNhdGlvbnMgb3ZlciB0aGUgTkRDcyBkaWZmZXJlbmNlIGluZGV4IGlzIHN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQgYW5kIG5lZ2F0aXZlICgkXGJldGEkID0gLTYwLjIzLCA5NSUgJENJJCBbLTg5LjYzLCAtMzAuODJdLCAkdCQoMTEpID0gLTQuNTEsICRwJCBcPCAuMDAxOyBTdGQuICRcYmV0YSQgPSAtMC44MSwgOTUlICRDSSQgWy0xLjIwLCAtMC40MV0pLg0KDQpgYGB7cn0NCm5kY3NfbW9kIDwtIGxtKERpZmZlcmVuY2UgfiBwb2lzX3JhdGUsIGRhdGEgPSBORENzKQ0KDQpzdW1tYXJ5KG5kY3NfbW9kKQ0KDQpgYGANCg0KIyBHb29nbGUgdHJlbmRzDQoNCkdvb2dsZSBwcm92aWRlcyBpbmZvcm1hdGlvbiBvbiB0aGUgaW50ZXJlc3Qgb3ZlciBjZXJ0YWluIHNlYXJjaCB0ZXJtcyB0aHJvdWdoIGEgIkludGVyZXN0IG92ZXIgdGltZSIgaW5kZXguIFRoaXMgaW5kZXggcmVwcmVzZW50IHNlYXJjaCBpbnRlcmVzdCByZWxhdGl2ZSB0byB0aGUgaGlnaGVzdCBwb2ludCBvbiB0aGUgY2hhcnQgZm9yIGEgZ2l2ZW4gcmVnaW9uIGFuZCB0aW1lLiBBIHZhbHVlIG9mIDEwMCBpcyB0aGUgcGVhayBwb3B1bGFyaXR5IGZvciB0aGUgdGVybS4gQSB2YWx1ZSBvZiA1MCBtZWFucyB0aGF0IHRoZSB0ZXJtIGlzIGhhbGYgYXMgcG9wdWxhci4gQSBzY29yZSBvZiAwIG1lYW5zIHRoZXJlIHdhcyBub3QgZW5vdWdoIGRhdGEgZm9yIHRoaXMgdGVybS4NCg0KVG8gZG93bmxvYWQgR29vZ2xlIHRyZW5kcyBkYXRhIHdlIHVzZWQgdGhlIGd0cmVuZHNSIHBhY2thZ2Ugd2hpY2ggY29ubmVjdHMgUiB0byBhIGd0cmVuZHMgQVBJLiBEb2N1bWVudGF0aW9uIG9uIHRoZSBwYWNrYWdlIGNhbiBiZSBmb3VuZCBbaGVyZV0oaHR0cHM6Ly9ndHJlbmRyLnJlYWR0aGVkb2NzLmlvL2VuL2xhdGVzdC8pLiBJbiB0aGlzIHN0dWR5IHdlIHdlcmUgaW50ZXJlc3RlZCBpbiBrbm93aW5nIHdoZXRoZXIgdGhlIGludGVyZXN0IG9uIG1hbmdyb3ZlcyBjaGFuZ2VkIHNpZ25pZmljYW50bHkgb3ZlciB0aW1lLg0KDQpGaXJzdCB3ZSBzZXQga2V5d29yZHMsIHdlIHNlbGVjdGVkIHRocmVlIGRpZmZlcmVudCBsYW5ndWFnZXMgd29ybGR3aWRlIHRocm91Z2ggYSB0aW1lIHNwYW4gZnJvbSAyMDA0IHRvIHRoZSBwcmVzZW50IGRheVteMV06DQoNClteMV06IE5vdGUgdGhhdCBpZiB5b3UgcnVuIHRoaXMgY29kZSBhZnRlciBhIHdoaWxlLCBpdCB3aWxsIGF1dG9tYXRpY2FsbHkgdXBkYXRlIHRvIHRoZSBsYXRlc3QgcmVzdWx0LCB0aHVzIGl0IG1pZ2h0IGRpZmZlciBmcm9tIHRoZSBwYXBlci4NCg0KYGBge3J9DQoNCnNlYXJjaF90ZXJtcyA8LSBjKCJNYW5ncm92ZSIsICJNYW5nbGFyIiwgIkJha2F1IikNCg0KDQpgYGANCg0KVGhlbiB3ZSByYW4gdGhlIEFQSSByZXF1ZXN0Og0KDQpgYGB7cn0NCiMgUXVlcmluZyB0aGUgQVBJDQoNCm91dHB1dF9yZXN1bHRzIDwtIGd0cmVuZHMoa2V5d29yZCA9IHNlYXJjaF90ZXJtcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZSA9ICJhbGwiKSANCg0KIyBHZXR0aW5nIGludGVyZXN0IG92ZXIgdGltZSByZXN1bHRzIGFuZCBjb252ZXJ0aW5nIHRoZW0gYXMgbnVtZXJpYw0KDQpvdXRwdXRfcmVzdWx0cyRpbnRlcmVzdF9vdmVyX3RpbWUkaGl0cyA8LSBhcy5udW1lcmljKG91dHB1dF9yZXN1bHRzJGludGVyZXN0X292ZXJfdGltZSRoaXRzKQ0KDQpgYGANCg0KTGV0J3MgcGxvdCB0aGUgZGF0YSBieSBrZXl3b3JkczoNCg0KYGBge3J9DQpvdXRwdXRfcmVzdWx0cyAlPiUgDQogICAgICAgICAgLiRpbnRlcmVzdF9vdmVyX3RpbWUgJT4lDQogICAgICAgICAgZmlsdGVyKGtleXdvcmQgIT0gIk1hbmdsYXJlcyIpICU+JSANCiAgICAgICAgICBnZ3Bsb3QoYWVzKHggPSBkYXRlLCB5ID0gaGl0cywgY29sID0ga2V5d29yZCkpICsNCiAgICAgICAgICBnZW9tX2xpbmUoKSArDQogICAgICAgICAgbGFicyh4ID0gIlRpbWUiLCANCiAgICAgICAgICAgICAgIHkgPSAiSW50ZXJlc3Qgb3ZlciB0aW1lIiwNCiAgICAgICAgICAgICAgIGNvbG9yID0gIktleXdvcmQiKSArDQogICAgICAgICAgdGhlbWVfYncoKSArDQogICAgICAgICAgdGhlbWUocGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSkNCg0KYGBgDQoNCkNsZWFybHksIHRoZSB3b3JkIG1vc3Qgc2VhcmNoZWQgZm9yIGlzIHRoZSBFbmdsaXNoIHRlcm0sIGludGVyZXN0aW5nbHksIHRoZSBTcGFuaXNoIHRlcm0gaGFkIGEgdmVyeSBsb3cgcG9wdWxhcml0eSBjb21wYXJlZCB0byB0aGUgb3RoZXIgbGFuZ3VhZ2VzLg0KDQojIyBBbmFseXNpbmcgdGhlIHRyZW5kLCBhbiBleGFtcGxlLg0KDQpUcmVuZHMgYXJlIGNsZWFybHkgbm9uLWxpbmVhciBzbyB3ZSBvcHRlZCB0byBhbmFseXNlIHRoZXNlIHRyZW5kcyB1c2luZyBHZW5lcmFsaXplZCBBZGRpdGl2ZSBNb2RlbHMgKEdBTXMpLiBBbGwgdHJlbmRzIHNob3cgc29tZSBkZWdyZWUgb2Ygd2l0aGluLXllYXIgc2Vhc29uYWxpdHkgd2hpY2ggd2UgZGVjaWRlZCB0byBpbmNsdWRlIGludG8gdGhlIG1vZGVscy4NCg0KIyMjIEVuZ2xpc2gNCg0KRmlyc3Qgd2UgZXh0cmFjdCB0aGUgRW5nbGlzaCBsYW5ndWFnZSBmcm9tIHRoZSBHb29nbGUgZGF0YToNCg0KYGBge3J9DQplbmdsX21vZCA8LSBvdXRwdXRfcmVzdWx0cyRpbnRlcmVzdF9vdmVyX3RpbWUgJT4lIA0KICAgICAgICAgIGZpbHRlcihrZXl3b3JkID09ICJNYW5ncm92ZSIpICU+JSANCiAgICAgICAgICBtdXRhdGUoeWVhciA9IGx1YnJpZGF0ZTo6eWVhcihkYXRlKSwgbW9udGggPSBsdWJyaWRhdGU6Om1vbnRoKGRhdGUpKQ0KDQpgYGANCg0KVGhlbiBhIEdBTSBtb2RlbCBpcyBmaXR0ZWQgdXNpbmcgdGhlIGBnYW1tYCBmdW5jdGlvbiBmcm9tIHRoZSBgbWdjdmAgcGFja2FnZS4gSW4gcGFydGljdWxhciwgd2UgbW9kZWwgR29vZ2xlIHRyZW5kIGRhdGEgYGhpdHNgIHdpdGggdHdvIHNtb290aHMsIG9uZSBmb3IgYSBtb250aCBwYXJhbWV0ZXIgdXNpbmcgYSBjeWNsaWMgc3BsaW5lICh3aGljaCBmb3JjZXMgc3RhcnRpbmcgcG9pbnQgdmFsdWVzIHRvIGNvaW5jaWRlIHdpdGggZmluYWwgb25lcyksIHBsdXMgYSB5ZWFyIHNtb290aCB3aGljaCB3ZSBsZWF2ZSB1bmRlZmluZWQgZm9yIG5vdy4NCg0KYGBge3J9DQoNCm0gPC0gZ2FtbShoaXRzIH4gcyhtb250aCwgYnMgPSAiY2MiLCBrID0gMTIpICsgcyh5ZWFyKSwNCiAgICAgICAgICBkYXRhID0gZW5nbF9tb2QpDQoNCmdyYXRpYTo6YXBwcmFpc2UobSRnYW0pDQoNCmBgYA0KDQpUaGVyZSBpcyBhIGJpdCBvZiBvdmVyZGlzcGVydGlvbiwgYnV0IGZpcnN0IGxldCdzIGFkZHJlc3MgdGVtcG9yYWwgYXV0b2NvcnJlbGF0aW9uLg0KDQpgYGB7ciBmaWcuc2hvdyA9ICJob2xkIn0NCg0KbGF5b3V0KG1hdHJpeCgxOjIsIG5jb2wgPSAyKSkNCmFjZihyZXNpZChtJGxtZSksIGxhZy5tYXggPSAzNiwgbWFpbiA9ICJBQ0YiKQ0KcGFjZihyZXNpZChtJGxtZSksIGxhZy5tYXggPSAzNiwgbWFpbiA9ICJwQUNGIikNCmxheW91dCgxKQ0KDQpgYGANCg0KV2UgY2FuIGFkZCBBUk1BIGNvcnJlbGF0aW9uIHN0cnVjdHVyZSB0byByZWR1Y2UgdGVtcG9yYWwgYXV0b2NvcnJlbGF0aW9uLg0KDQpgYGB7ciBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFLCBpbmNsdWRlPUZBTFNFfQ0KDQpjZXQgPC0gdHJhbnNmb3JtKGVuZ2xfbW9kLCBUaW1lID0gYXMubnVtZXJpYyhkYXRlKSAvIDEwMDApDQoNCmN0cmwgPC0gbGlzdChuaXRlckVNID0gMCwgbXNWZXJib3NlID0gVFJVRSwgb3B0aW1NZXRob2Q9IkwtQkZHUy1CIikNCiMjIEFSKDEpDQptMSA8LSBnYW1tKGhpdHMgfiBzKG1vbnRoLCBicyA9ICJjYyIsIGsgPSAxMikgKyBzKFRpbWUsIGsgPSAyMCksDQogICAgICAgICAgIGRhdGEgPSBjZXQsIGNvcnJlbGF0aW9uID0gY29yQVJNQShmb3JtID0gfiAxfHllYXIsIHAgPSAxKSwNCiAgICAgICAgICAgY29udHJvbCA9IGN0cmwpDQojIyBBUigyKQ0KbTIgPC0gZ2FtbShoaXRzIH4gcyhtb250aCwgYnMgPSAiY2MiLCBrID0gMTIpICsgcyhUaW1lLCBrID0gMjApLA0KICAgICAgICAgICBkYXRhID0gY2V0LCBjb3JyZWxhdGlvbiA9IGNvckFSTUEoZm9ybSA9IH4gMXx5ZWFyLCBwID0gMiksDQogICAgICAgICAgIGNvbnRyb2wgPSBjdHJsKQ0KDQojIyBBUigzKQ0KbTMgPC0gZ2FtbShoaXRzIH4gcyhtb250aCwgYnMgPSAiY2MiLCBrID0gMTIpICsgcyhUaW1lLCBrID0gMjApLA0KICAgICAgICAgICBkYXRhID0gY2V0LCBjb3JyZWxhdGlvbiA9IGNvckFSTUEoZm9ybSA9IH4gMXx5ZWFyLCBwID0gMyksDQogICAgICAgICAgIGNvbnRyb2wgPSBjdHJsKQ0KYGBgDQoNCmBgYHtyfQ0KYW5vdmEobSRsbWUsIG0xJGxtZSwgbTIkbG1lLCBtMyRsbWUpDQoNCg0KYGBgDQoNCk1vZGVsIGBtMWAgaXMgdGhlIGJlc3QuDQoNCmBgYHtyIGZpZy5zaG93ID0gImhvbGQifQ0KDQpsYXlvdXQobWF0cml4KDE6MiwgbmNvbCA9IDIpKQ0KcmVzIDwtIHJlc2lkKG0xJGxtZSwgdHlwZSA9ICJub3JtYWxpemVkIikNCmFjZihyZXMsIG1haW4gPSAiQUNGIC0gQVIoMikgZXJyb3JzIikNCnBhY2YocmVzLCAgbWFpbiA9ICJwQUNGLSBBUigyKSBlcnJvcnMiKQ0KbGF5b3V0KDEpDQoNCmBgYA0KDQpgYGB7ciBnYW1wbG90LCBmaWcuY2FwPSJNb2RlbCBzbW9vdGVycyJ9DQoNCmRyYXcobTEkZ2FtKSArDQogICAgICAgICAgdGhlbWVfYncoKQ0KYGBgDQoNCkZyb20gRmlndXJlIFxAcmVmKGZpZzpnYW1wbG90KSB0aGVyZSBpcyBsZXNzIGludGVyZXN0IG92ZXIgdGhlIGxhdGUgc3ByaW5nIHN1bW1lciBtb250aHMsIGFuZCBhZnRlciBKdWx5IGludGVyZXN0IHNlZW1zIHRvIHJhaXNlIGFnYWluLiBXZSBjYW4gY2FsY3VsYXRlIGRlcml2YXRpdmVzIChjb2RlIGJlbG93KSB0byBzZWUgc2lnbmlmaWNhbnQgaW5jcmVhc2VzIG92ZXIgdGltZToNCg0KYGBge3J9DQoNCndhbnQgPC0gc2VxKDEsIG5yb3coY2V0KSwgbGVuZ3RoLm91dCA9IDIxNCkNCnBkYXQgPC0gd2l0aChjZXQsDQogICAgICAgICAgICAgZGF0YS5mcmFtZShUaW1lID0gVGltZVt3YW50XSwgZGF0ZSA9IGRhdGVbd2FudF0sDQogICAgICAgICAgICAgICAgICAgICAgICBtb250aCA9IG1vbnRoW3dhbnRdKSkNCnAyIDwtIHByZWRpY3QobTEkZ2FtLCBuZXdkYXRhID0gcGRhdCwgdHlwZSA9ICJ0ZXJtcyIsIHNlLmZpdCA9IFRSVUUpDQpwZGF0IDwtIHRyYW5zZm9ybShwZGF0LCBwMiA9IHAyJGZpdFssMl0sIHNlMiA9IHAyJHNlLmZpdFssMl0pDQoNCmRmLnJlcyA8LSBkZi5yZXNpZHVhbChtMSRnYW0pDQpjcml0LnQgPC0gcXQoMC4wMjUsIGRmLnJlcywgbG93ZXIudGFpbCA9IEZBTFNFKQ0KcGRhdCA8LSB0cmFuc2Zvcm0ocGRhdCwNCiAgICAgICAgICAgICAgICAgIHVwcGVyID0gcDIgKyAoY3JpdC50ICogc2UyKSwNCiAgICAgICAgICAgICAgICAgIGxvd2VyID0gcDIgLSAoY3JpdC50ICogc2UyKSkNCg0KDQoNClRlcm0gPC0gIlRpbWUiDQptMS5kIDwtIERlcml2KG0xJGdhbSkNCg0KbTEuZGNpIDwtIGNvbmZpbnQobTEuZCwgdGVybSA9IFRlcm0pDQptMS5kc2lnIDwtIHNpZ25pZkQocGRhdCRwMiwgZCA9IG0xLmRbW1Rlcm1dXSRkZXJpdiwNCiAgICAgICAgICAgICAgICAgICBtMS5kY2lbW1Rlcm1dXSR1cHBlciwgbTEuZGNpW1tUZXJtXV0kbG93ZXIpDQoNCg0KeWxpbSA8LSB3aXRoKHBkYXQsIHJhbmdlKHVwcGVyLCBsb3dlciwgcDIpKQ0KDQpkZXJpdmF0aXZlcyA8LSBkYXRhLmZyYW1lKA0KICAgICAgICAgIGRhdGUgPSBwZGF0JGRhdGUsDQogICAgICAgICAgaW5jcmVhc2luZyA9IHVubGlzdChtMS5kc2lnJGluY3IpLCANCiAgICAgICAgICBkZWNyZWFzaW5nID0gdW5saXN0KG0xLmRzaWckZGVjciksIA0KICAgICAgICAgIHJlc2lkdWFscyA9IHJlc2lkdWFscyhtMSRnYW0pICsgcGRhdCRwMg0KKQ0KDQoNCihlbmdsaXNoX3Bsb3QgPC0gcGRhdCAlPiUgDQogICAgICAgICAgZ2dwbG90KGFlcyh4ID0gZGF0ZSwgeSA9IHAyKSkgKw0KICAgICAgICAgIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAgKSArDQogICAgICAgICAgI2dlb21fcG9pbnQoZGF0YSA9IGRlcml2YXRpdmVzLCBhZXMoeD1kYXRlLCB5PXJlc2lkdWFscyksIGNvbCA9ICJncmF5OTAiKSArDQogICAgICAgICAgZ2VvbV9saW5lKGRhdGEgPSBkZXJpdmF0aXZlcywgYWVzKHg9ZGF0ZSwgeT1yZXNpZHVhbHMpLCBjb2wgPSAiZ3JheTkwIikgKw0KICAgICAgICAgIGdlb21fcmliYm9uKGFlcyh5bWluID0gbG93ZXIsIHltYXggPSB1cHBlciksIGZpbGwgPSAiZ3JleTcwIiwgYWxwaGEgPSAuNSkgKw0KICAgICAgICAgIGdlb21fbGluZSgpICsNCiAgICAgICAgICBnZW9tX2xpbmUoZGF0YSA9IGRlcml2YXRpdmVzLCANCiAgICAgICAgICAgICAgICAgICAgYWVzKHg9ZGF0ZSwgeT1pbmNyZWFzaW5nKSwgDQogICAgICAgICAgICAgICAgICAgIGNvbCA9ICJyZWQiLA0KICAgICAgICAgICAgICAgICAgICBzaXplID0gMS4yKSArDQogICAgICAgICAgbGFicyh4ID0gIlRpbWUiLCB5ID0gIkVmZmVjdCIpICsNCiAgICAgICAgICB0aGVtZV9idygpICsNCiAgICAgICAgICB0aGVtZShwYW5lbC5ncmlkID0gZWxlbWVudF9ibGFuaygpKSkNCiAgICAgICAgDQogDQpgYGANCg0KIyMgVGhlIDEzIGNvdW50cmllcyBieSBsYW5ndWFnZQ0KDQpGaXJzdCwgd2UgY3JlYXRlIGxpc3RzIG9mIGNvdW50cmllcyBieSBsYW5ndWFnZS4gSWYgd2UgZG9uJ3Qgc2VwYXJhdGUgY291bnRyaWVzIGJ5IGxhbmd1YWdlLCB0aGUgZ3RyZW5kIHRvb2wgd2lsbCAqY29tcGFyZSoga2V5d29yZHMgd2l0aGluIHRoZSBjb3VudHJ5IGluc3RlYWQgb2YgZ2l2aW5nIG92ZXJhbGwgcmVzdWx0cy4gQ29tcGFyaW5nIHRlcm0gcG9wdWxhcml0eSBpbiBkaWZmZXJlbnQgbGFuZ3VhZ2VzIHdpdGhpbiB0aGUgc2FtZSBjb3VudHJ5IGRvZXMgbm90IHJlYWxseSBtYWtlIHNlbnNlLiBUaHVzLCBieSBjcmVhdGluZyBhIGxpc3QgYnkgbGFuZ3VhZ2Ugd2UgY2FuIHRoZW4gc2VhcmNoIHRoZSB3YW50ZWQga2V5d29yZCB3aXRoaW4gdGhhdCBsaXN0Lg0KDQpgYGB7cn0NCiMgT25seSAxMyBjb3VudHJpZXMgYnkgbGFuZ3VhZ2UsIGlmIHdhbnRlZCBjb3VudHJpZXMgY2FuIGJlIGFkZGVkIGJ5IHVzaW5nIGlzbzIgY29kZSwgZS5nLiBmb3IgdGhlIFVTQSB3b3VsZCBiZSBVUyBvciBVbml0ZWQgS2luZ29tOiBVSy4gDQoNCmVuZ19zcGVha2luZyA8LSBjKCJBVSIsICJJRCIsICJORyIpDQpwb3J0dWd1ZXNlX3NwZWFraW5nIDwtIGMoIkJSIiwgIk1aIikNCmJha2F1X3NwZWFraW5nIDwtIGMoIkJEIiwgIklOIiwgIk1NIiwgIk1ZIiwgIlBHIikNCnNwYW5pc2hfc3BlYWtpbmcgPC0gYygiQ1UiLCAiTVgiLCAiVkUiKQ0KDQpgYGANCg0KTm93LCB3ZSB1c2UgYSBjdXN0b20gZnVuY3Rpb24gdGhhdCBzZWFyY2hlcyBmb3IgdGhlIGtleXdvcmQgYnkgbG9vcGluZyBvdmVyIHRoZSBjb3VudHJ5IGxpc3QuDQoNCmBgYHtyIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQoNCmVuZ19kYXRhIDwtIHNlYXJjaF9ndHJlbmRzKGVuZ19zcGVha2luZywga2V5d29yZCA9ICJNYW5ncm92ZSIpDQoNCnBvcnRfZGF0YSA8LSBzZWFyY2hfZ3RyZW5kcyhwb3J0dWd1ZXNlX3NwZWFraW5nLCBrZXl3b3JkID0gIk1hbmd1ZSIpDQoNCmJha19kYXRhIDwtIHNlYXJjaF9ndHJlbmRzKGJha2F1X3NwZWFraW5nLCBrZXl3b3JkID0gIkJha2F1IikNCg0Kc3BhX2RhdGEgPC0gc2VhcmNoX2d0cmVuZHMoc3BhbmlzaF9zcGVha2luZywga2V5d29yZCA9ICJNYW5nbGFyIikNCg0KIyBoZXJlIHdlIGpvaW4gYWxsIGxhbmd1YWdlcw0KDQpnb29nbGVfdHJlbmRzX2RhdGEgPC0gcmJpbmQoZW5nX2RhdGEsIHBvcnRfZGF0YSwgYmFrX2RhdGEsIHNwYV9kYXRhKQ0KDQpgYGANCg0KYGBge3J9DQoNCmdvb2dsZV90cmVuZHNfZGF0YSAlPiUgDQogICAgICAgICAgZ2dwbG90KGFlcyh4PWRhdGUsIHk9aGl0cykpICsNCiAgICAgICAgICBnZW9tX2xpbmUoKSsNCiAgICAgICAgICBmYWNldF93cmFwKH5jb3VudHJ5KSArDQogICAgICAgICAgbGFicyh4PSJEYXRlIiwgeT0iR29vZ2xlIHRyZW5kIGluZGV4IikgKw0KICAgICAgICAgIHRoZW1lX2J3KCkgKw0KICAgICAgICAgIHRoZW1lKHBhbmVsLmdyaWQgPSBlbGVtZW50X2JsYW5rKCkpDQoNCmBgYA0KDQojIyBUb3BpY3Mgd29yZGNsb3VkDQoNCldlIGNhbiBzZWUgd29yZGNsb3VkcyBvZiByZWxhdGVkIHF1ZXJpZXMgdGhhdCB3ZXJlIHNlYXJjaGVkLCBhbmQgcmVsYXRlZCB0b3BpY3MgdG8gTWFuZ3JvdmVzIGluIGdvb2dsZSB0cmVuZHMuDQoNCmBgYHtyfQ0KDQp3b3JkY2xvdWRfdG9waWNzKCJNYW5ncm92ZSIsdHlwZSA9ICJRdWVyaWVzIikNCg0KYGBgDQoNCmBgYHtyfQ0KDQp3b3JkY2xvdWRfdG9waWNzKCJNYW5ncm92ZSIsdHlwZSA9ICJUb3BpY3MiKQ0KDQpgYGANCg0KIyMgTGV0J3MgbWFwIHRoZSByZXN1bHRzIGJ5IGNvdW50cnkNCg0KYGBge3IgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCg0KbWFuZ3JvdmVfbWFwIDwtIG1hcF9rZXl3b3JkX2NvdW50cnkoa2V5d29yZCA9ICJNYW5ncm92ZSIpDQoNCm1hbmd1ZV9tYXAgPC0gbWFwX2tleXdvcmRfY291bnRyeShrZXl3b3JkID0gIk1hbmd1ZSIpDQoNCm1hbmdsYXJfbWFwIDwtIG1hcF9rZXl3b3JkX2NvdW50cnkoa2V5d29yZCA9ICJNYW5nbGFyIikNCg0KYmFrYXVfbWFwIDwtIG1hcF9rZXl3b3JkX2NvdW50cnkoa2V5d29yZCA9ICJCYWthdSIpDQoNCg0KKG1hbmdyb3ZlX21hcCArIG1hbmd1ZV9tYXApIC8gKG1hbmdsYXJfbWFwICsgYmFrYXVfbWFwKQ0KDQpgYGANCg0KIyMjIA0K</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("supplementary_methods2.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
